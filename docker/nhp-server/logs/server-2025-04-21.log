2025/04/21 03:39:11 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:39:11 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.4.0.250417071249 started              ===
2025/04/21 03:39:11 udpserver.go:128: NHP-Server [Info] === REVISION 9571814d8e6426b7740c0c08fc67d90ac1196901 ===
2025/04/21 03:39:11 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-17 07:12:49                       ===
2025/04/21 03:39:11 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 03:39:12 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:39:12 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.4.0.250417071249 started              ===
2025/04/21 03:39:12 udpserver.go:128: NHP-Server [Info] === REVISION 9571814d8e6426b7740c0c08fc67d90ac1196901 ===
2025/04/21 03:39:12 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-17 07:12:49                       ===
2025/04/21 03:39:12 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:39:12 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.4.0.250417071249 started              ===
2025/04/21 03:39:12 udpserver.go:128: NHP-Server [Info] === REVISION 9571814d8e6426b7740c0c08fc67d90ac1196901 ===
2025/04/21 03:39:12 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-17 07:12:49                       ===
2025/04/21 03:39:12 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 03:39:13 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:39:13 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.4.0.250417071249 started              ===
2025/04/21 03:39:13 udpserver.go:128: NHP-Server [Info] === REVISION 9571814d8e6426b7740c0c08fc67d90ac1196901 ===
2025/04/21 03:39:13 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-17 07:12:49                       ===
2025/04/21 03:39:14 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:39:14 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.4.0.250417071249 started              ===
2025/04/21 03:39:14 udpserver.go:128: NHP-Server [Info] === REVISION 9571814d8e6426b7740c0c08fc67d90ac1196901 ===
2025/04/21 03:39:15 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:39:15 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.4.0.250417071249 started              ===
2025/04/21 03:39:15 udpserver.go:128: NHP-Server [Info] === REVISION 9571814d8e6426b7740c0c08fc67d90ac1196901 ===
2025/04/21 03:39:25 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:39:25 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.4.0.250417071249 started              ===
2025/04/21 03:39:25 udpserver.go:128: NHP-Server [Info] === REVISION 9571814d8e6426b7740c0c08fc67d90ac1196901 ===
2025/04/21 03:39:38 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:40:55 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:40:55 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.4.0.250417071249 started              ===
2025/04/21 03:40:55 udpserver.go:128: NHP-Server [Info] === REVISION 9571814d8e6426b7740c0c08fc67d90ac1196901 ===
2025/04/21 03:40:55 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-17 07:12:49                       ===
2025/04/21 03:40:55 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 03:41:56 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:41:56 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.4.0.250417071249 started              ===
2025/04/21 03:41:56 udpserver.go:128: NHP-Server [Info] === REVISION 9571814d8e6426b7740c0c08fc67d90ac1196901 ===
2025/04/21 03:43:56 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:43:56 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.4.0.250417071249 started              ===
2025/04/21 03:43:56 udpserver.go:128: NHP-Server [Info] === REVISION 9571814d8e6426b7740c0c08fc67d90ac1196901 ===
2025/04/21 03:43:56 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-17 07:12:49                       ===
2025/04/21 03:43:56 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 03:44:31 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:44:31 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421034017 started              ===
2025/04/21 03:44:31 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 03:44:31 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:40:17                       ===
2025/04/21 03:44:32 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:44:32 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421034017 started              ===
2025/04/21 03:44:33 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:44:33 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421034017 started              ===
2025/04/21 03:44:33 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 03:44:33 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:40:17                       ===
2025/04/21 03:44:35 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:44:35 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421034017 started              ===
2025/04/21 03:44:35 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 03:44:44 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:44:44 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421034017 started              ===
2025/04/21 03:44:44 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 03:45:23 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:45:23 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421034017 started              ===
2025/04/21 03:45:23 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 03:46:14 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:46:14 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421034017 started              ===
2025/04/21 03:46:14 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 03:46:14 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:40:17                       ===
2025/04/21 03:46:14 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 03:46:14 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 03:46:14 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 03:46:14 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 03:46:14 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 03:46:14 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 03:46:14 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 03:46:14) started  ===
2025/04/21 03:46:14 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 03:46:14 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 03:46:14 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 03:46:14 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 03:46:14 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 03:46:14 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 03:46:14 main.go:105: Plugin[example] [Error] failed to read base config: open /nhp-server/plugins/example/etc/config.toml: no such file or directory
2025/04/21 03:46:14 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 03:46:14 main.go:124: Plugin[example] [Error] failed to read resource config: open /nhp-server/plugins/example/etc/resource.toml: no such file or directory
2025/04/21 03:46:14 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 03:46:14 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 03:46:14 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 03:46:14 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 03:46:14 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 03:46:14 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 03:46:14 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 03:46:14 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 03:46:14 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 03:46:14 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 03:46:14 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 03:46:14 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 03:46:14 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 03:46:14 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 03:46:14 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 03:46:14 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 03:46:14 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 03:46:14 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 03:46:14 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 03:46:14 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 03:46:14 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 03:46:14 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 03:46:14 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 03:46:14 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 03:46:14 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 03:46:14 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 03:46:14 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 03:46:14 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 03:46:14 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 03:46:14 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 03:46:22 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33176 -> [::]:62206), 293 bytes
2025/04/21 03:46:22 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:33176
2025/04/21 03:46:22 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:33176 to [::]:62206
2025/04/21 03:46:22 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:33176 started
2025/04/21 03:46:22 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33176
2025/04/21 03:46:22 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 03:46:22 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:46:22 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:QGiV3fE9siKwu0GgTJfUzAlvfhgaC32b9gakGZGcdbkAJiimi1MSn/TTd+ysEABSqBSnURWoI6D4UxvRZfoCyw==
2025/04/21 03:46:22 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:Bg6ucRn5f/bTIuyn70UnXsyIEKUwkpZYn6UdQd0sWu4=,NonceBytes:AAAAAAAAAAAAAAAH,StaticBytes:tNjvUXUUFODOZXORQLWSWjTA5nyCxCgEPPosebD8H5nwpBm6/REb0zuArbRrRojYWSxADHqW37AaHBxiUUSiVG3jIAUGRJwQvLyw+qkDZak=
2025/04/21 03:46:22 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:46:22 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:46:22 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:46:22 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:46:22 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:46:22 transaction.go:229: NHP-Server [Debug] Remote transaction 7 start
2025/04/21 03:46:22 transaction.go:249: NHP-Server [Debug] Remote transaction 7 quit
2025/04/21 03:46:22 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33176"}
2025/04/21 03:46:22 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AAK]
2025/04/21 03:46:22 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:46:22 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:46:22 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33176), 297 bytes
2025/04/21 03:46:42 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33176 -> [::]:62206), 160 bytes
2025/04/21 03:46:42 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33176
2025/04/21 03:46:42 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33176 -> [::]:62206)
2025/04/21 03:47:02 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33176 -> [::]:62206), 160 bytes
2025/04/21 03:47:02 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33176
2025/04/21 03:47:02 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33176 -> [::]:62206)
2025/04/21 03:47:22 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33176 -> [::]:62206), 293 bytes
2025/04/21 03:47:22 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33176
2025/04/21 03:47:22 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-AOL] raw packet
2025/04/21 03:47:22 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:47:22 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:moaN76lCBa8Sf7uqDrIovep1D38WGlVAuBzyCeJahyW9ZzvW5RJ/gslVXcnpGDuMR9rtivKzuXLgrMYYCYp9QA==
2025/04/21 03:47:22 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:PGhQSSZmQ2EK+1clK2Dio070bshH9tk/CUnF5W2LoKs=,NonceBytes:AAAAAAAAAAAAAAAK,StaticBytes:DLHnIE3CzqaEkMcE74vYcvZEu9rKxGJe7rxu5NJWNw9FJ+HrOm0IRmFdFlQOxLQDpOYFQuKj+mwtPGIh6fU/a8ytBzHQphgIriWJy/NpcOI=
2025/04/21 03:47:22 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:47:22 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:47:22 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:47:22 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:47:22 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:47:22 transaction.go:229: NHP-Server [Debug] Remote transaction 10 start
2025/04/21 03:47:22 transaction.go:249: NHP-Server [Debug] Remote transaction 10 quit
2025/04/21 03:47:22 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33176"}
2025/04/21 03:47:22 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AAK]
2025/04/21 03:47:22 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:47:22 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:47:22 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33176), 297 bytes
2025/04/21 03:47:36 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:47:36 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:47:36 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:47:36 | 200 |    3.610541ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
[GIN] 2025/04/21 - 03:47:36 | 404 |         542ns |    192.168.65.1 | GET      "/favicon.ico"
2025/04/21 03:47:42 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33176 -> [::]:62206), 160 bytes
2025/04/21 03:47:42 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33176
2025/04/21 03:47:42 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33176 -> [::]:62206)
2025/04/21 03:48:02 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33176 -> [::]:62206), 160 bytes
2025/04/21 03:48:02 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33176
2025/04/21 03:48:02 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33176 -> [::]:62206)
2025/04/21 03:48:22 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33176 -> [::]:62206), 293 bytes
2025/04/21 03:48:22 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33176
2025/04/21 03:48:22 device.go:335: NHP-Server [Debug] packetToMsgRoutine 7: decrypting [NHP-AOL] raw packet
2025/04/21 03:48:22 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:48:22 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:+4wh9sfBqPxS8A06MMcq6Cuoe9aGxprrpRcBhNUb17Dphz1CSe4XLTeR+j2LEHfkL+8ZsOAmPLVf+bvBs7zlfg==
2025/04/21 03:48:22 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:XjpgVFnZz3RVvGpzYXqhBaAYyMC+D/AynqTrq1BDbas=,NonceBytes:AAAAAAAAAAAAAAAN,StaticBytes:YaYhXPGQBaFzLogch1hgtTv4Z8Wq7tzUrZ8p7Yut/M9Mpi7tKVbNb8AUnK2GI76ymRmB9Bv2t165nTWc87X/tJDdXdMizZcr0tJpEE2WxbU=
2025/04/21 03:48:22 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 7: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:48:22 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:48:22 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:48:22 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:48:22 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:48:22 transaction.go:229: NHP-Server [Debug] Remote transaction 13 start
2025/04/21 03:48:22 transaction.go:249: NHP-Server [Debug] Remote transaction 13 quit
2025/04/21 03:48:22 device.go:182: NHP-Server [Debug] msgToPacketRoutine 8: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33176"}
2025/04/21 03:48:22 device.go:233: NHP-Server [Debug] msgToPacketRoutine 8: complete encrypting [NHP-AAK]
2025/04/21 03:48:22 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:48:22 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:48:22 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33176), 297 bytes
2025/04/21 03:48:42 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33176 -> [::]:62206), 160 bytes
2025/04/21 03:48:42 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33176
2025/04/21 03:48:42 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33176 -> [::]:62206)
2025/04/21 03:48:53 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:48:53 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:48:53 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:48:53 | 200 |    1.064042ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:48:55 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:48:55 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:48:55 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:48:55 | 200 |     299.291µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:48:56 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:48:56 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:48:56 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:48:56 | 200 |     106.209µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:48:56 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:48:56 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:48:56 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:48:56 | 200 |       159.5µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:48:56 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:48:56 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:48:56 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:48:56 | 200 |      89.292µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:48:56 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:48:56 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:48:56 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:48:56 | 200 |      97.625µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:48:56 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:48:56 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:48:56 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:48:56 | 200 |     103.083µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:48:57 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:48:57 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:48:57 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:48:57 | 200 |     162.958µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:48:57 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:48:57 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:48:57 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:48:57 | 200 |      96.041µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:01 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:01 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:01 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:01 | 200 |     424.291µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:01 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:01 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:01 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:01 | 200 |     121.792µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:01 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:01 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:01 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:01 | 200 |      82.417µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:02 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:02 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:02 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:02 | 200 |     260.041µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:02 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:02 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:02 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:02 | 200 |       80.25µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:02 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:02 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:02 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:02 | 200 |      72.666µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:02 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:02 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:02 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:02 | 200 |       109.5µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:02 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:02 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:02 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:02 | 200 |     123.084µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:03 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:03 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:03 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:03 | 200 |     110.916µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:03 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:03 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:03 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:03 | 200 |         142µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:03 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:03 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:03 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:03 | 200 |     116.167µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:03 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:03 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:03 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:03 | 200 |     102.666µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:03 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:03 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:03 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:03 | 200 |      66.167µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:03 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:03 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:03 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:03 | 200 |     185.125µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:04 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:04 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:04 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:04 | 200 |     157.166µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:04 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:04 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:04 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:04 | 200 |     139.167µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:04 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:04 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:04 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:04 | 200 |    1.995542ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:04 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:04 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:04 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:04 | 200 |     118.959µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:04 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:04 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:04 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:04 | 200 |      162.75µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:05 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:05 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:05 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:05 | 200 |      90.833µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:05 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:05 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:05 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:05 | 200 |     101.375µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:05 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:05 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:05 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:05 | 200 |      79.208µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:05 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:05 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:05 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:05 | 200 |       82.25µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:05 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:05 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:05 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:05 | 200 |      81.708µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:05 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:05 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:05 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:05 | 200 |     102.667µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:06 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:06 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:06 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:06 | 200 |     139.459µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:06 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:06 main.go:184: Plugin[example] [Error] resource error: failed to find resource
2025/04/21 03:49:06 httpauth.go:27: NHP-Server [Info] auth error: failed to find resource
[GIN] 2025/04/21 - 03:49:06 | 200 |      86.333µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:08 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:49:08 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421034017 started              ===
2025/04/21 03:49:08 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 03:49:08 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:40:17                       ===
2025/04/21 03:49:08 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 03:49:08 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 03:49:08 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 03:49:08 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 03:49:08 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 03:49:08 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 03:49:08 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 03:49:08) started  ===
2025/04/21 03:49:08 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 03:49:08 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 03:49:08 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 03:49:08 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 03:49:08 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 03:49:08 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 03:49:08 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 03:49:08 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 03:49:08 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 03:49:08 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 03:49:08 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 03:49:08 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 03:49:08 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 03:49:08 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 03:49:08 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 03:49:08 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 03:49:08 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 03:49:08 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 03:49:08 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 03:49:08 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 03:49:08 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 03:49:08 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 03:49:08 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 03:49:08 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 03:49:08 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 03:49:08 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 03:49:08 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 03:49:08 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 03:49:08 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 03:49:08 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 03:49:08 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 03:49:08 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 03:49:08 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 03:49:08 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 03:49:08 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 03:49:08 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 03:49:08 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 03:49:08 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:55607 -> [::]:62206), 293 bytes
2025/04/21 03:49:08 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:55607
2025/04/21 03:49:08 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:55607 to [::]:62206
2025/04/21 03:49:08 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:55607 started
2025/04/21 03:49:08 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:55607
2025/04/21 03:49:08 device.go:335: NHP-Server [Debug] packetToMsgRoutine 9: decrypting [NHP-AOL] raw packet
2025/04/21 03:49:08 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:49:08 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:h1sKDf1fvnMDE1WwTjDglzRsto9i5joESIxYaOZl+sQto/lM56VbITffCQaDmd5/Ndsj/JcV9cLb2jtQ44FA+g==
2025/04/21 03:49:08 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:3JftlbknDnVBA5Q4JyhzN/plCTxY0N3xy712ELtALUA=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:rxndq2XdkoUMl67p5ygyI9ukax5j1Ob/lFTfeDDuPJngzlscOUu1cj9zpC7GRjJ0RjCtd0YwZu0QmdIAMmMITpPZ9wZLaC/pc3ssq5XUqBw=
2025/04/21 03:49:08 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 9: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:49:08 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:49:08 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:49:08 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:49:08 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:49:08 transaction.go:229: NHP-Server [Debug] Remote transaction 1 start
2025/04/21 03:49:08 transaction.go:249: NHP-Server [Debug] Remote transaction 1 quit
2025/04/21 03:49:08 device.go:182: NHP-Server [Debug] msgToPacketRoutine 5: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:55607"}
2025/04/21 03:49:08 device.go:233: NHP-Server [Debug] msgToPacketRoutine 5: complete encrypting [NHP-AAK]
2025/04/21 03:49:08 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:49:08 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:49:08 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:55607), 297 bytes
2025/04/21 03:49:10 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:49:10 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 03:49:10 | 200 |     3.65025ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:49:28 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:55607 -> [::]:62206), 160 bytes
2025/04/21 03:49:28 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:55607
2025/04/21 03:49:28 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:55607 -> [::]:62206)
2025/04/21 03:49:48 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:55607 -> [::]:62206), 160 bytes
2025/04/21 03:49:48 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:55607
2025/04/21 03:49:48 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:55607 -> [::]:62206)
2025/04/21 03:50:08 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:55607 -> [::]:62206), 293 bytes
2025/04/21 03:50:08 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:55607
2025/04/21 03:50:08 device.go:335: NHP-Server [Debug] packetToMsgRoutine 5: decrypting [NHP-AOL] raw packet
2025/04/21 03:50:08 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:50:08 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:Vkt7XVb7/vvApYxNxV5+Tr4sdqkhN+njnEcAkPsWjIfIXDN7wOmC8KBGIr4G+apxGJXL7Wk9UwK+0a9N8wnuhw==
2025/04/21 03:50:08 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:oRpKTyhmzOEDP5x1L0EUQXL373lNLf/ojEf4etW1o1c=,NonceBytes:AAAAAAAAAAAAAAAE,StaticBytes:+F71dzY0aeJIPsyCA8fdCr71SFJw9XcXdWnUTAQCNwX8fS85ru3xBtY2mRU28gGLQ7fcNfmIVZ5729eVACG2p3eLusJKObwbMNczeWvxczs=
2025/04/21 03:50:08 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 5: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:50:08 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:50:08 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:50:08 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:50:08 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:50:08 transaction.go:229: NHP-Server [Debug] Remote transaction 4 start
2025/04/21 03:50:08 transaction.go:249: NHP-Server [Debug] Remote transaction 4 quit
2025/04/21 03:50:08 device.go:182: NHP-Server [Debug] msgToPacketRoutine 9: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:55607"}
2025/04/21 03:50:08 device.go:233: NHP-Server [Debug] msgToPacketRoutine 9: complete encrypting [NHP-AAK]
2025/04/21 03:50:08 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:50:08 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:50:08 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:55607), 297 bytes
2025/04/21 03:50:28 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:55607 -> [::]:62206), 160 bytes
2025/04/21 03:50:28 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:55607
2025/04/21 03:50:28 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:55607 -> [::]:62206)
2025/04/21 03:50:48 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:55607 -> [::]:62206), 160 bytes
2025/04/21 03:50:48 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:55607
2025/04/21 03:50:48 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:55607 -> [::]:62206)
2025/04/21 03:51:08 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:55607 -> [::]:62206), 293 bytes
2025/04/21 03:51:08 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:55607
2025/04/21 03:51:08 device.go:335: NHP-Server [Debug] packetToMsgRoutine 6: decrypting [NHP-AOL] raw packet
2025/04/21 03:51:08 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:51:08 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:m9AtxfM9aPNZbfcsbS5ZnYk1zVm1xtp6D3zNWXsj/T6X4u6kWxQ6mbwPu2hfjTpyNUN+jb54wKlc0pEroVzk6w==
2025/04/21 03:51:08 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:NaAkhJenHCnuAnDPXN+eS8PUhfxGhQUXPD/FQhFd7tg=,NonceBytes:AAAAAAAAAAAAAAAH,StaticBytes:DNMWD6LS36UpBcTmGM3ZcuSJifgeslWsbKgI29hTqTsdEyhSqoI/O8C+DNv1nlw3HulJZ1tQXMZN0QmeeL46pejvzoYkVq5U8+jP6PdkmkM=
2025/04/21 03:51:08 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 6: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:51:08 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:51:08 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:51:08 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:51:08 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:51:08 transaction.go:229: NHP-Server [Debug] Remote transaction 7 start
2025/04/21 03:51:08 transaction.go:249: NHP-Server [Debug] Remote transaction 7 quit
2025/04/21 03:51:08 device.go:182: NHP-Server [Debug] msgToPacketRoutine 6: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:55607"}
2025/04/21 03:51:08 device.go:233: NHP-Server [Debug] msgToPacketRoutine 6: complete encrypting [NHP-AAK]
2025/04/21 03:51:08 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:51:08 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:51:08 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:55607), 297 bytes
2025/04/21 03:51:28 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:55607 -> [::]:62206), 160 bytes
2025/04/21 03:51:28 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:55607
2025/04/21 03:51:28 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:55607 -> [::]:62206)
2025/04/21 03:51:48 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:55607 -> [::]:62206), 160 bytes
2025/04/21 03:51:48 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:55607
2025/04/21 03:51:48 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:55607 -> [::]:62206)
2025/04/21 03:52:08 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:55607 -> [::]:62206), 293 bytes
2025/04/21 03:52:08 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:55607
2025/04/21 03:52:08 device.go:335: NHP-Server [Debug] packetToMsgRoutine 7: decrypting [NHP-AOL] raw packet
2025/04/21 03:52:08 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:52:08 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:OjQQ41IvmGLrXGlOvUveOXnRIipSNivu9U/OvihHR69F4jZdRcaU+cWqsLOw/mWf0fJhU5uf5bdUfebXfiPvZA==
2025/04/21 03:52:08 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:FZmen1ut9RJXUvYwCUK0awsmpm3OvXXoojHDGeA6ke4=,NonceBytes:AAAAAAAAAAAAAAAK,StaticBytes:GIkVdhc2xq7NXswOwGhF9Rgvt73UnRca7/ZDqCh9EuqH4pc56hP1TQABzalUWEdbBBmWkxksqxgHUTukemZqEiZwdkdnbD44mZtX+BPu8t0=
2025/04/21 03:52:08 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 7: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:52:08 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:52:08 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:52:08 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:52:08 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:52:08 transaction.go:229: NHP-Server [Debug] Remote transaction 10 start
2025/04/21 03:52:08 transaction.go:249: NHP-Server [Debug] Remote transaction 10 quit
2025/04/21 03:52:08 device.go:182: NHP-Server [Debug] msgToPacketRoutine 7: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:55607"}
2025/04/21 03:52:08 device.go:233: NHP-Server [Debug] msgToPacketRoutine 7: complete encrypting [NHP-AAK]
2025/04/21 03:52:08 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:52:08 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:52:08 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:55607), 297 bytes
2025/04/21 03:52:28 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:55607 -> [::]:62206), 160 bytes
2025/04/21 03:52:28 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:55607
2025/04/21 03:52:28 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:55607 -> [::]:62206)
2025/04/21 03:52:43 config.go:91: NHP-Server [Info] ac peer config: /nhp-server/etc/ac.toml has been updated
2025/04/21 03:52:48 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:55607 -> [::]:62206), 160 bytes
2025/04/21 03:52:48 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:55607
2025/04/21 03:52:48 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:55607 -> [::]:62206)
2025/04/21 03:53:16 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:53:16 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421034017 started              ===
2025/04/21 03:53:16 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 03:53:16 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:40:17                       ===
2025/04/21 03:53:16 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 03:53:16 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 03:53:16 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 03:53:16 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 03:53:16 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 03:53:16 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 03:53:16 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 03:53:16) started  ===
2025/04/21 03:53:16 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 03:53:16 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 03:53:16 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 03:53:16 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 03:53:16 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 03:53:16 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 03:53:16 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 03:53:16 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 03:53:16 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 03:53:16 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 03:53:16 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 03:53:16 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 03:53:16 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 03:53:16 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 03:53:16 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 03:53:16 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 03:53:16 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 03:53:16 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 03:53:16 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 03:53:16 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 03:53:16 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 03:53:16 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 03:53:16 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 03:53:16 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 03:53:16 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 03:53:16 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 03:53:16 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 03:53:16 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 03:53:16 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 03:53:16 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 03:53:16 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 03:53:16 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 03:53:16 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 03:53:16 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 03:53:16 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 03:53:16 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 03:53:16 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 03:53:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:29687 -> [::]:62206), 293 bytes
2025/04/21 03:53:17 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:29687
2025/04/21 03:53:17 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:29687 to [::]:62206
2025/04/21 03:53:17 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:29687 started
2025/04/21 03:53:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:29687
2025/04/21 03:53:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 03:53:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:53:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:wOMaYCH5qr8L+oI2g9SGyU7ugt4i495p2C2EDmoabLVCliXgPJr+M+WebMy6+EmVvdipFPkWAIvNWzegTZU2lQ==
2025/04/21 03:53:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:BdDwMf3kHqGjgqb/fALNBzoMEikuGcQshOG+7z7WLS8=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:XnLyYPwgun/XiNvK/GmbW9dBtmKiAyCrynRD0Kb8eKa8bva9wgV2sdjXMcEIvwxpnWgUyUyI5mQoULBOx82+8eCmAQN4+CrQkOUSVyqeoDM=
2025/04/21 03:53:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:53:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:53:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:53:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:53:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:53:17 transaction.go:229: NHP-Server [Debug] Remote transaction 1 start
2025/04/21 03:53:17 transaction.go:249: NHP-Server [Debug] Remote transaction 1 quit
2025/04/21 03:53:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:29687"}
2025/04/21 03:53:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AAK]
2025/04/21 03:53:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:53:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:53:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:29687), 297 bytes
2025/04/21 03:53:24 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:53:24 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 03:53:24 | 200 |    5.336458ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:53:25 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:53:25 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 03:53:25 | 200 |     564.875µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:53:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:29687 -> [::]:62206), 160 bytes
2025/04/21 03:53:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:29687
2025/04/21 03:53:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:29687 -> [::]:62206)
2025/04/21 03:53:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:29687 -> [::]:62206), 160 bytes
2025/04/21 03:53:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:29687
2025/04/21 03:53:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:29687 -> [::]:62206)
2025/04/21 03:54:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:29687 -> [::]:62206), 293 bytes
2025/04/21 03:54:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:29687
2025/04/21 03:54:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-AOL] raw packet
2025/04/21 03:54:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:54:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:tkH7Wmz6AdUN9r9UMgsEUHCW9yUHhxDkm/VOOAlrOvmNoJ1Oz7fsdXDc9ZKKyZ3PoEmHg0dnvSiq4h45c+OJHg==
2025/04/21 03:54:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:SZovtnDQ+FtHRnVkJhuER9rjjPCIGK6/SowJh1fZ0Pc=,NonceBytes:AAAAAAAAAAAAAAAE,StaticBytes:iSpQw7OSK+9rrCfdUVH5beKnnckKBlzzeVIF+lIBndXXmmOEIO7jg4ERXmbKQp9h0VMfdBObfIQxhHavDum4cOGpaM73hg6LVCdHLT1aJlk=
2025/04/21 03:54:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:54:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:54:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:54:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:54:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:54:17 transaction.go:229: NHP-Server [Debug] Remote transaction 4 start
2025/04/21 03:54:17 transaction.go:249: NHP-Server [Debug] Remote transaction 4 quit
2025/04/21 03:54:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:29687"}
2025/04/21 03:54:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AAK]
2025/04/21 03:54:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:54:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:54:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:29687), 297 bytes
2025/04/21 03:54:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:29687 -> [::]:62206), 160 bytes
2025/04/21 03:54:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:29687
2025/04/21 03:54:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:29687 -> [::]:62206)
2025/04/21 03:54:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:29687 -> [::]:62206), 160 bytes
2025/04/21 03:54:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:29687
2025/04/21 03:54:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:29687 -> [::]:62206)
2025/04/21 03:55:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:29687 -> [::]:62206), 293 bytes
2025/04/21 03:55:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:29687
2025/04/21 03:55:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-AOL] raw packet
2025/04/21 03:55:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:55:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:gVFIeURv5vMdx8MHK9fm4b/5HSqqamIiWgswBTarwjZQgaW1mxdtWCo8Du8O4sQOuZCXlD8tnfMqN9gDiE6Y5g==
2025/04/21 03:55:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:/fCi7Tbtm5aWE2JNcze5bSFyh3jFdXuzXlC+rmG99jY=,NonceBytes:AAAAAAAAAAAAAAAH,StaticBytes:H1mz82QLu5IjcR7m5BC/OWl0b42zZxPFPYyPvdjK+7z8+JLhDEyb/kwciOVX3xjMKK7QHsCfPyctasm4oNSWzouLxBQyK6gvqPsaaBWlBJk=
2025/04/21 03:55:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:55:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:55:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:55:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:55:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:55:17 transaction.go:229: NHP-Server [Debug] Remote transaction 7 start
2025/04/21 03:55:17 transaction.go:249: NHP-Server [Debug] Remote transaction 7 quit
2025/04/21 03:55:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 7: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:29687"}
2025/04/21 03:55:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 7: complete encrypting [NHP-AAK]
2025/04/21 03:55:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:55:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:55:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:29687), 297 bytes
2025/04/21 03:55:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:29687 -> [::]:62206), 160 bytes
2025/04/21 03:55:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:29687
2025/04/21 03:55:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:29687 -> [::]:62206)
2025/04/21 03:55:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:29687 -> [::]:62206), 160 bytes
2025/04/21 03:55:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:29687
2025/04/21 03:55:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:29687 -> [::]:62206)
2025/04/21 03:56:05 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:56:05 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 03:56:05 | 200 |      4.6605ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:56:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:29687 -> [::]:62206), 293 bytes
2025/04/21 03:56:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:29687
2025/04/21 03:56:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 03:56:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:56:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:gm5SOt/OQk35odcmpbhq4wlIW6JQus4iImpdhVFNKBaSr08qPN68Xqm8D4h5qy9q+oH4pHbYKMYhYnY8gQYCvw==
2025/04/21 03:56:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:0Ye899w2I6MNmmviIltjT/UwUKxzTPfcaOf+R78+2H0=,NonceBytes:AAAAAAAAAAAAAAAK,StaticBytes:OfAt9ZrXml5opQ/wC76r88FSXFo4HGrdUu3vsaYsq97PczXbq753cRZF3QK4XOf/7xnEzUWFMKmdrgQITVPz/6R/VZ9YQ+w+Q++gfDthJLs=
2025/04/21 03:56:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:56:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:56:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:56:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:56:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:56:17 transaction.go:229: NHP-Server [Debug] Remote transaction 10 start
2025/04/21 03:56:17 transaction.go:249: NHP-Server [Debug] Remote transaction 10 quit
2025/04/21 03:56:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:29687"}
2025/04/21 03:56:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AAK]
2025/04/21 03:56:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:56:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:56:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:29687), 297 bytes
2025/04/21 03:56:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:29687 -> [::]:62206), 160 bytes
2025/04/21 03:56:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:29687
2025/04/21 03:56:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:29687 -> [::]:62206)
2025/04/21 03:56:46 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 03:56:46 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421035448 started              ===
2025/04/21 03:56:46 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 03:56:46 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:54:48                       ===
2025/04/21 03:56:46 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 03:56:46 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 03:56:46 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 03:56:46 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 03:56:46 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 03:56:46 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 03:56:46 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 03:56:46) started  ===
2025/04/21 03:56:46 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 03:56:46 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 03:56:46 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 03:56:46 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 03:56:46 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 03:56:46 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 03:56:46 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 03:56:46 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 03:56:46 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 03:56:46 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 03:56:46 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 03:56:46 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 03:56:46 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 03:56:46 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 03:56:46 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 03:56:46 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 03:56:46 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 03:56:46 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 03:56:46 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 03:56:46 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 03:56:46 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 03:56:46 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 03:56:46 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 03:56:46 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 03:56:46 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 03:56:46 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 03:56:46 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 03:56:46 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 03:56:46 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 03:56:46 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 03:56:46 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 03:56:46 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 03:56:46 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 03:56:46 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 03:56:46 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 03:56:46 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 03:56:46 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 03:56:49 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:56:49 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 03:56:49 | 200 |     917.125µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:56:51 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 03:56:51 httpserver.go:365: NHP-Server [Error] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)-ac(@testAC-1)[HandleHttpKnockRequest] no ac connection is available
2025/04/21 03:56:51 main.go:237: Plugin[example] [Error] knock failed. ackMsg is nil
2025/04/21 03:56:51 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 03:56:51 | 200 |     786.791µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 03:56:57 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 03:56:57 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 03:56:57 | 200 |     190.459µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 03:56:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 03:56:57 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:33896 to [::]:62206
2025/04/21 03:56:57 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:33896 started
2025/04/21 03:56:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 03:56:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 03:56:58 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 03:56:58 httpserver.go:365: NHP-Server [Error] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)-ac(@testAC-1)[HandleHttpKnockRequest] no ac connection is available
2025/04/21 03:56:58 main.go:237: Plugin[example] [Error] knock failed. ackMsg is nil
2025/04/21 03:56:58 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 03:56:58 | 200 |     114.708µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 03:57:01 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 03:57:01 httpserver.go:365: NHP-Server [Error] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)-ac(@testAC-1)[HandleHttpKnockRequest] no ac connection is available
2025/04/21 03:57:01 main.go:237: Plugin[example] [Error] knock failed. ackMsg is nil
2025/04/21 03:57:01 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 03:57:01 | 200 |     255.375µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 03:57:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 03:57:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 03:57:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 03:57:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:57:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:pznXTbhYVP4JmRxH3mn1OsQ0HCy7757cljYufIwLXdZOcZ4c0PYRPgILPbSc4x3Elkmy/NQ+mHoI35AEChzrEg==
2025/04/21 03:57:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:tYvo1dcxJJzz1xXj4rfPiQ7FfgbAjowACFaZdDh8fOk=,NonceBytes:AAAAAAAAAAAAAAAN,StaticBytes:iwgQQHdQhmg6WloC8hSeCcHwyo4NIM9ui0uEzr3L01Zi4oU/KRWTAqpchVZhfduXhCJJKGJO9zLrqMz3DLVPzYKqB6X2kluEdaK5ddZFAyM=
2025/04/21 03:57:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:57:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:57:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:57:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:57:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:57:17 transaction.go:229: NHP-Server [Debug] Remote transaction 13 start
2025/04/21 03:57:17 transaction.go:249: NHP-Server [Debug] Remote transaction 13 quit
2025/04/21 03:57:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 03:57:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AAK]
2025/04/21 03:57:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:57:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:57:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 03:57:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 03:57:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 03:57:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 03:57:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 03:57:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 03:57:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 03:58:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 03:58:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 03:58:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-AOL] raw packet
2025/04/21 03:58:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:58:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:G7gvfSqpf6/Xg+eXnIPl9AB4pZ/aescvxHCSP4b+7Aue5iUMQ32uAJBDhTDrfG1EgW6LIB+9ahCHJwdu3cxbxA==
2025/04/21 03:58:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:cKNZ3eLTFzNyf25R6m1bqsy04mYKGRn6VkUgWR6HfRM=,NonceBytes:AAAAAAAAAAAAAAAQ,StaticBytes:7jB6pfMpoBIV8BDpQsYwYWey8hTGkfnTcESdTXwj4L3IOVfNyAzaTcuV6R+7li3EdGRkSITkqHGaHTvYZOskJwlOw7igJh1VDZ5c0K6gSlk=
2025/04/21 03:58:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:58:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:58:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:58:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:58:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:58:17 transaction.go:229: NHP-Server [Debug] Remote transaction 16 start
2025/04/21 03:58:17 transaction.go:249: NHP-Server [Debug] Remote transaction 16 quit
2025/04/21 03:58:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 03:58:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AAK]
2025/04/21 03:58:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:58:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:58:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 03:58:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 03:58:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 03:58:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 03:58:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 03:58:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 03:58:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 03:59:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 03:59:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 03:59:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-AOL] raw packet
2025/04/21 03:59:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 03:59:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:WIwdV59/rgby9SWNtauim+r5Q49rqAHeSZuZMBrLuq+eZXCuTuSVNB/R5aTnDd3Io874B7WVPAANrh4oGzpXoA==
2025/04/21 03:59:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:FSHzuV0rId1UCI/ogAvYxlMrFLPZq3tdcD96FB0Henw=,NonceBytes:AAAAAAAAAAAAAAAT,StaticBytes:FPvRSE3vN+3neVUxRZMiuNdTE67nj30cwBll+4Rcuu4UYi7dAKJVNyZGxK3Vw/JGRmstwqSwIewXknnSeThRhYJoJHwvJnsg9rH81m40dXY=
2025/04/21 03:59:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 03:59:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 03:59:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 03:59:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:59:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 03:59:17 transaction.go:229: NHP-Server [Debug] Remote transaction 19 start
2025/04/21 03:59:17 transaction.go:249: NHP-Server [Debug] Remote transaction 19 quit
2025/04/21 03:59:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 7: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 03:59:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 7: complete encrypting [NHP-AAK]
2025/04/21 03:59:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 03:59:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 03:59:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 03:59:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 03:59:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 03:59:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 03:59:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 03:59:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 03:59:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:00:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:00:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:00:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 04:00:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:00:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:Fj9VQDE1+XOPlZeSU9yMGdmwrjAPArGG7enu4fXn7hG9QLOIkSz4kxR05CJmn5P0BfrMMHhoGbB7qxhCuyF6ZQ==
2025/04/21 04:00:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:PCHplzKOWaMTTnXaPrlVcVBj8g6BlyjM3TDh82MzFwM=,NonceBytes:AAAAAAAAAAAAAAAW,StaticBytes:ppQBGuf86vAzJpWGq461yZn4365+gGn9ol8bvw8eA3e2OU1kROjwF84gI6CUf5CLraLiK8d7A4FJTxd7lGr6cF8nyM3bUrEF+mU0ctvhvro=
2025/04/21 04:00:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:00:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:00:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:00:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:00:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:00:17 transaction.go:229: NHP-Server [Debug] Remote transaction 22 start
2025/04/21 04:00:17 transaction.go:249: NHP-Server [Debug] Remote transaction 22 quit
2025/04/21 04:00:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:00:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AAK]
2025/04/21 04:00:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:00:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:00:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:00:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:00:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:00:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:00:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:00:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:00:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:01:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:01:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:01:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 4: decrypting [NHP-AOL] raw packet
2025/04/21 04:01:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:01:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:iFaXv+l8xnWnhvGSDdJJY07zL3mzAlFvmFlg1bpYOBd/OrX6VdQWzlqHPPUjQx6m9hqwyMSkAHRziQE/iiiJdg==
2025/04/21 04:01:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:Rw2NOINSlylWoJkBSgPWPpwHUD1D62CGpf52dVSC98E=,NonceBytes:AAAAAAAAAAAAAAAZ,StaticBytes:X1mRW1DEnRbck/lZ/ZePdBt0vMH5kjUkEdTOmpISFMViO2Eow2BwEM8wrMoNfF/vkPPALkGyLY0yZ3h5tU2B0KfuLMjgo0Dz1J9Ooa0fmr4=
2025/04/21 04:01:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 4: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:01:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:01:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:01:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:01:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:01:17 transaction.go:229: NHP-Server [Debug] Remote transaction 25 start
2025/04/21 04:01:17 transaction.go:249: NHP-Server [Debug] Remote transaction 25 quit
2025/04/21 04:01:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 3: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:01:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 3: complete encrypting [NHP-AAK]
2025/04/21 04:01:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:01:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:01:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:01:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:01:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:01:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:01:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:01:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:01:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:02:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:02:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:02:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 5: decrypting [NHP-AOL] raw packet
2025/04/21 04:02:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:02:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:mJJJaLFY3dFaz1dMnTv5+nHkUoeTkhXDii0iuNtpx2MSPTTNh4z9jyrYYvNOlHM1msaYb0KMrrUj1ALCbPZHgQ==
2025/04/21 04:02:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:USgw0jFqzs31HfK3tBanojOQueCV6H5RviOrhoa62Xc=,NonceBytes:AAAAAAAAAAAAAAAc,StaticBytes:LTyStw4E+NRbPIL0qP2BypZZ9GUxDG9bTf9KnkgbAaL+WhGXiM2J+FKFTizTmAIQfgn+8NC/khL21UXHTAAc4E1XYBjG6hy8INFLyzY1nMc=
2025/04/21 04:02:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 5: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:02:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:02:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:02:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:02:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:02:17 transaction.go:229: NHP-Server [Debug] Remote transaction 28 start
2025/04/21 04:02:17 transaction.go:249: NHP-Server [Debug] Remote transaction 28 quit
2025/04/21 04:02:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 4: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:02:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 4: complete encrypting [NHP-AAK]
2025/04/21 04:02:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:02:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:02:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:02:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:02:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:02:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:02:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:02:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:02:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:03:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:03:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:03:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 6: decrypting [NHP-AOL] raw packet
2025/04/21 04:03:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:03:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:8pIpQWRFw+eYocbfUkTTlvpqk8jDEdy3rpcRyRdJI/G7apJwE3KXq2oNFVbUb6v/TRzl9Dwb4AD/Nl5Lbj8F/A==
2025/04/21 04:03:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:KHaDgjK31l/MmOS1xRx/WAqwglA73RpcdUWIZc/beZo=,NonceBytes:AAAAAAAAAAAAAAAf,StaticBytes:vpm+UKWIvS7qKUut4y7dfHb115G7mFJLwUr9S+intFLif23ck1JwQ73nOrVe+D6puzmKIVsAa+WCjxDyvAk764UXHQfKbY6G6b54l/pxRbM=
2025/04/21 04:03:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 6: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:03:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:03:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:03:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:03:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:03:17 transaction.go:229: NHP-Server [Debug] Remote transaction 31 start
2025/04/21 04:03:17 transaction.go:249: NHP-Server [Debug] Remote transaction 31 quit
2025/04/21 04:03:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 5: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:03:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 5: complete encrypting [NHP-AAK]
2025/04/21 04:03:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:03:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:03:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:03:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:03:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:03:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:03:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:03:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:03:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:04:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:04:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:04:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 7: decrypting [NHP-AOL] raw packet
2025/04/21 04:04:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:04:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:gKmocFyXhX5GG13MuZVVbRt/WoKP+WUk8R40Xtnl0qMEKqrRPmxyWJoE0fiPeFrm00n2TUHmYNgCoTwhV1e87w==
2025/04/21 04:04:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:CPHd8KDZqUbd6Bq777RLuB+mfmISQsc+GeIDOd6sa2Y=,NonceBytes:AAAAAAAAAAAAAAAi,StaticBytes:eABF+79HXJ7a8x0w00v4I7vkUoSF1RHKc/ZID2dzaEkAWSoO2BzYxxAiGJWOzcktlJ2mnOavabI6fNNtDlIUepRajv04GC9xgxOO+M++RlY=
2025/04/21 04:04:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 7: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:04:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:04:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:04:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:04:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:04:17 transaction.go:229: NHP-Server [Debug] Remote transaction 34 start
2025/04/21 04:04:17 transaction.go:249: NHP-Server [Debug] Remote transaction 34 quit
2025/04/21 04:04:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 6: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:04:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 6: complete encrypting [NHP-AAK]
2025/04/21 04:04:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:04:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:04:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:04:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:04:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:04:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:04:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:04:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:04:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:05:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:05:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:05:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 8: decrypting [NHP-AOL] raw packet
2025/04/21 04:05:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:05:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:2blFE2QFadvktilJ9/yBZNdKCH45qsq2bnSo4WKcyjM2nyGe0PyIpn7m8PUfXAHXXcFo721c2e4QHjnkt4jjdQ==
2025/04/21 04:05:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:N8mtZYtgCdD9ovD1Ew++4Xuj4PfrJYDRd6pBN2ZNyaI=,NonceBytes:AAAAAAAAAAAAAAAl,StaticBytes:vEQ/cYnYkZG6UpTZfNj+2FLR8Dw1jpF87gpkBHf+BgDVqIGjokiQYp6NCjSDJkqkUlRSS+L73xDIpn++M8mjD3JC2AIXSJW+CZn3P2Lk15g=
2025/04/21 04:05:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 8: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:05:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:05:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:05:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:05:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:05:17 transaction.go:229: NHP-Server [Debug] Remote transaction 37 start
2025/04/21 04:05:17 transaction.go:249: NHP-Server [Debug] Remote transaction 37 quit
2025/04/21 04:05:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 8: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:05:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 8: complete encrypting [NHP-AAK]
2025/04/21 04:05:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:05:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:05:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:05:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:05:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:05:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:05:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:05:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:05:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:06:18 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:06:18 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:06:18 device.go:335: NHP-Server [Debug] packetToMsgRoutine 9: decrypting [NHP-AOL] raw packet
2025/04/21 04:06:18 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:06:18 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:oFb3H/hKrtcWCLuCE8cRWF/+S301Yq7nMKDk3+VXtDOADcWuideAsH5emdIZNFZvi4YgwJ0oQ0qWpWt8/5SiNQ==
2025/04/21 04:06:18 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:SQd/9ZGv7Z+Q67swR+pqiAJCef78npcg+pdvAA2hp+o=,NonceBytes:AAAAAAAAAAAAAAAo,StaticBytes:00KKWhkb6zE6BNNuxXufUQIapZDT2QiNawjeULhaNoVxyRSCP8Qjf5ojlJwHD2UDDc+q12HfPGogqW3K6qu7CUvdgJz0F0THrEKRm4hpc3w=
2025/04/21 04:06:18 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 9: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:06:18 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:06:18 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:06:18 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:06:18 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:06:18 transaction.go:229: NHP-Server [Debug] Remote transaction 40 start
2025/04/21 04:06:18 transaction.go:249: NHP-Server [Debug] Remote transaction 40 quit
2025/04/21 04:06:18 device.go:182: NHP-Server [Debug] msgToPacketRoutine 9: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:06:18 device.go:233: NHP-Server [Debug] msgToPacketRoutine 9: complete encrypting [NHP-AAK]
2025/04/21 04:06:18 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:06:18 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:06:18 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:06:38 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:06:38 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:06:38 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:06:58 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:06:58 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:06:58 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:07:18 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:07:18 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:07:18 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 04:07:18 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:07:18 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:6WlrY7adFLRqTe52U5Si5Pz5kN+Q21EULgnwq5igTyBF0ZNJ1k0Ati2zk6718wvjHqSIlYPAgoJOtkweZqSqjA==
2025/04/21 04:07:18 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:ba4jyD2TlLp/vovoOYmp42eY/OXJtyKJq7pwE935HO4=,NonceBytes:AAAAAAAAAAAAAAAr,StaticBytes:y1J179JMW83MFdsypHsbIKOJ4XIfoGPOWwCi8Q5SiVJl2DcnOh7l+3IIV2gL0i4XVNGIHOPwjxcG+bZCSbIHtRMzwHRPPOVfquWEPjRZJK0=
2025/04/21 04:07:18 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:07:18 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:07:18 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:07:18 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:07:18 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:07:18 transaction.go:229: NHP-Server [Debug] Remote transaction 43 start
2025/04/21 04:07:18 transaction.go:249: NHP-Server [Debug] Remote transaction 43 quit
2025/04/21 04:07:18 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:07:18 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AAK]
2025/04/21 04:07:18 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:07:18 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:07:18 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:22:39 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:22:39 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:22:39 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-AOL] raw packet
2025/04/21 04:22:39 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:22:39 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:wX1ajSdWQsMNz0CEj4ExS7ahANSZs75KrafLPRI2IgSIXQWCSQU3Q6gb4co5sOPVFH0U1VpJewcY5GxMMnWj6g==
2025/04/21 04:22:39 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:ZgjucttpvNMXiI7pKgWDPQb9kGn5Z59oVKRgPOiMuTU=,NonceBytes:AAAAAAAAAAAAAAAs,StaticBytes:i4KbiYtnSqP/p6CdY4D7ZZBx0G0mgiB2KBodJpWdy56tAvqRZXBaluOGKGp5ZqBfupJK5Riw+cj86v88lySFu10Mi0H5VhzJQ98aZmqQPSw=
2025/04/21 04:22:39 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:22:39 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:22:39 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:22:39 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:22:39 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:22:39 transaction.go:229: NHP-Server [Debug] Remote transaction 44 start
2025/04/21 04:22:39 transaction.go:249: NHP-Server [Debug] Remote transaction 44 quit
2025/04/21 04:22:39 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:22:39 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AAK]
2025/04/21 04:22:39 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:22:39 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:22:39 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:22:59 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:22:59 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:22:59 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:23:19 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:23:19 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:23:19 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:32:12 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:32:12 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:32:12 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-AOL] raw packet
2025/04/21 04:32:12 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:32:12 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:4gaYOMHT/HAl83joG1wo45ZGGahNOe70o3kGaoDX74DXclty4Gi9X1mksuW+YOFkoUYUDGjiYjO1AHD9Y/04MA==
2025/04/21 04:32:12 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:w+dN35lCFvUTp1li9YyHLQTLhq8lfDtblWGogGXH4oU=,NonceBytes:AAAAAAAAAAAAAAAv,StaticBytes:COcbwPX8eRDpVAN6VjVEzw+DjuWJz6+lTSYSxs72ju7Mt8THzxpA0zIpipQHvjnnMZBIupE91r1mvfHBAatiWHQiFVsPfyeAdazwL0swggI=
2025/04/21 04:32:12 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:32:12 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:32:12 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:32:12 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:32:12 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:32:12 transaction.go:229: NHP-Server [Debug] Remote transaction 47 start
2025/04/21 04:32:12 transaction.go:249: NHP-Server [Debug] Remote transaction 47 quit
2025/04/21 04:32:12 device.go:182: NHP-Server [Debug] msgToPacketRoutine 7: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:32:12 device.go:233: NHP-Server [Debug] msgToPacketRoutine 7: complete encrypting [NHP-AAK]
2025/04/21 04:32:12 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:32:12 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:32:12 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:32:32 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:32:32 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:32:32 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:32:52 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:32:52 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:32:52 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 04:48:26 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 04:48:26 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 04:48:26 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 04:48:26 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 04:48:26 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:IFbK8PCOSdYtq0d+Cdv84eJHPbsOD+/HC/ihZHao4DdDMcOgoJkxY9Zt9NHhRmVxrIYYh11tMZoOXqMsFDBe3Q==
2025/04/21 04:48:26 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:WtikKnIDYj4+T61rOdJgWoRegPGt2pjs/CJlL2DGIZ8=,NonceBytes:AAAAAAAAAAAAAAAy,StaticBytes:6bTcUc8Nx7+skyVuYZb71sDAyXRzCg5+kZn5PKaZs3J+1OrdE9klYXbEde21ptLARYITbv9cn5qNi8Qq8lqACiMg2v3XXnWRFf+mfWxor00=
2025/04/21 04:48:26 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 04:48:26 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 04:48:26 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 04:48:26 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:48:26 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 04:48:26 transaction.go:229: NHP-Server [Debug] Remote transaction 50 start
2025/04/21 04:48:26 transaction.go:249: NHP-Server [Debug] Remote transaction 50 quit
2025/04/21 04:48:26 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 04:48:26 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AAK]
2025/04/21 04:48:26 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 04:48:26 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 04:48:26 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 04:48:46 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 04:48:46 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 04:48:46 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:04:15 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:04:15 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:04:15 device.go:335: NHP-Server [Debug] packetToMsgRoutine 4: decrypting [NHP-AOL] raw packet
2025/04/21 05:04:15 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:04:15 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:AlA1iCg+7nrYXmhXJMSxifsn7h4O2GSG89ySX2lu/4r7V8NmRG46EnsjeVpP/YaesRxlBjRK8PZNXTNxXBj/Gg==
2025/04/21 05:04:15 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:+rjwmZa1Zb6QV5qpdAKGUalDAcUbjf2w5YjxWfO1uPs=,NonceBytes:AAAAAAAAAAAAAAA0,StaticBytes:pd16IMBP1vcR7/b2l5/7PsrRuz+8WD+3FPdIGuqNVWUEsNW6zOkGTQ5sgAbIU64s62vbgLAqc/uikq3AgCR5ojmzr9DoQNoQ5Z5V5STUil8=
2025/04/21 05:04:15 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 4: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:04:15 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:04:15 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:04:15 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:04:15 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:04:15 transaction.go:229: NHP-Server [Debug] Remote transaction 52 start
2025/04/21 05:04:15 transaction.go:249: NHP-Server [Debug] Remote transaction 52 quit
2025/04/21 05:04:15 device.go:182: NHP-Server [Debug] msgToPacketRoutine 3: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:04:15 device.go:233: NHP-Server [Debug] msgToPacketRoutine 3: complete encrypting [NHP-AAK]
2025/04/21 05:04:15 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:04:15 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:04:15 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:04:35 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:04:35 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:04:35 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:04:55 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:04:55 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:04:55 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:20:24 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:20:24 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:20:24 device.go:335: NHP-Server [Debug] packetToMsgRoutine 5: decrypting [NHP-AOL] raw packet
2025/04/21 05:20:24 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:20:24 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:VHDP/XbHMc8qW+M1HdywQyTWq8gsYwPRFr4/5nE1gUkGVVhvi5T4HtoiFjYrbNrTiGa0EzaHMkqEX1weiJ8NAg==
2025/04/21 05:20:24 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:ANxRzVfZ3D/hyucPlpjEonZP4x7l3Y898nIK6qiXvlQ=,NonceBytes:AAAAAAAAAAAAAAA3,StaticBytes:0xp5/bqJghwoIDx1ZcyyZk6pkJwKDqKFN/MbVdG+K6Db+jKxS7Uw+lL5DNI+NbbgQMpEzTio3SW0S5q9d8qaTImY9McyxpXeTLIyB3drZCk=
2025/04/21 05:20:24 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 5: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:20:24 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:20:24 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:20:24 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:20:24 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:20:24 transaction.go:229: NHP-Server [Debug] Remote transaction 55 start
2025/04/21 05:20:24 transaction.go:249: NHP-Server [Debug] Remote transaction 55 quit
2025/04/21 05:20:24 device.go:182: NHP-Server [Debug] msgToPacketRoutine 4: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:20:24 device.go:233: NHP-Server [Debug] msgToPacketRoutine 4: complete encrypting [NHP-AAK]
2025/04/21 05:20:24 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:20:24 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:20:24 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:20:45 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:20:45 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:20:45 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:34:10 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:34:10 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:34:10 device.go:335: NHP-Server [Debug] packetToMsgRoutine 6: decrypting [NHP-AOL] raw packet
2025/04/21 05:34:10 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:34:10 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:jslyb3SzLUiz4V07S4MYCD+2xq9JXNJ+2TtfHg4d1Fr2tz6/vbsMcxe6GUoa6Bluuchxxo9PPjcadTEeaegbMg==
2025/04/21 05:34:10 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:LEvyB8HW6p3dEetImfmO5yjDcfp3RuNwlCR4KkD3aDc=,NonceBytes:AAAAAAAAAAAAAAA5,StaticBytes:UbuKwQS8nHOGGYYgAzWQz5e3P65ahkXTvbEKEOBOHTQO67vh/wG8/bkDyEgkKS45Yxofrz4vD/1MDeIzhBefVYyqgKPUWLiHURkxDYE9ZKk=
2025/04/21 05:34:10 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 6: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:34:10 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:34:10 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:34:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:34:10 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:34:10 transaction.go:229: NHP-Server [Debug] Remote transaction 57 start
2025/04/21 05:34:10 transaction.go:249: NHP-Server [Debug] Remote transaction 57 quit
2025/04/21 05:34:10 device.go:182: NHP-Server [Debug] msgToPacketRoutine 5: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:34:10 device.go:233: NHP-Server [Debug] msgToPacketRoutine 5: complete encrypting [NHP-AAK]
2025/04/21 05:34:10 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:34:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:34:10 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:34:30 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:34:30 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:34:30 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:34:50 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:34:50 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:34:50 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:35:10 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:35:10 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:35:10 device.go:335: NHP-Server [Debug] packetToMsgRoutine 7: decrypting [NHP-AOL] raw packet
2025/04/21 05:35:10 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:35:10 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:6SaCejnAa5K+TfckwQ+0VcSKhGKP76emBQJ6vjK+fCio5Umv0zQ11xYf4tcERJ/W4j414gqsS/RkukxWADNXog==
2025/04/21 05:35:10 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:eiPMLuqSgdC1XJSxpeOsxaikrs5g1d0E6C605vrsQcQ=,NonceBytes:AAAAAAAAAAAAAAA8,StaticBytes:sohDy1uuNhxn9DL54mS3J1oHsL67XWUy38XDIH3mSI+S5AwvXVmT6SYx9aIFYGwDetDbsJ+sN3MZnOAr5uLnU6Hi+QRoqeGDMgILSKbbuq0=
2025/04/21 05:35:10 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 7: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:35:10 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:35:10 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:35:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:35:10 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:35:10 transaction.go:229: NHP-Server [Debug] Remote transaction 60 start
2025/04/21 05:35:10 transaction.go:249: NHP-Server [Debug] Remote transaction 60 quit
2025/04/21 05:35:10 device.go:182: NHP-Server [Debug] msgToPacketRoutine 6: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:35:10 device.go:233: NHP-Server [Debug] msgToPacketRoutine 6: complete encrypting [NHP-AAK]
2025/04/21 05:35:10 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:35:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:35:10 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:35:30 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:35:30 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:35:30 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:35:50 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:35:50 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:35:50 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:36:10 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:36:10 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:36:10 device.go:335: NHP-Server [Debug] packetToMsgRoutine 8: decrypting [NHP-AOL] raw packet
2025/04/21 05:36:10 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:36:10 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:xC9I1rzhc7EaRZwEl41A884MdWbEcQ/ziNwEzL0u6sGXEoPP9HonuLGLHDB+AQNnG8GLDFq8lyyeoOuJB7NQ6A==
2025/04/21 05:36:10 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:4YavM9/zmL4grjy4yKBSF9iV4LRwxQMq4vaYLnyZVT8=,NonceBytes:AAAAAAAAAAAAAAA/,StaticBytes:1SysZSLfhEV/0Qrt9r/qqQF2tYZYjaEDLXiaZEX34aFQ45kIdRJL4rB4YJNywn5ZZ9uXtTXYZAqvoottAPXYt/+Cw8jTIihpIhSFbmNjoIU=
2025/04/21 05:36:10 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 8: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:36:10 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:36:10 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:36:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:36:10 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:36:10 transaction.go:229: NHP-Server [Debug] Remote transaction 63 start
2025/04/21 05:36:10 transaction.go:249: NHP-Server [Debug] Remote transaction 63 quit
2025/04/21 05:36:10 device.go:182: NHP-Server [Debug] msgToPacketRoutine 8: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:36:10 device.go:233: NHP-Server [Debug] msgToPacketRoutine 8: complete encrypting [NHP-AAK]
2025/04/21 05:36:10 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:36:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:36:10 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:36:30 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:36:30 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:36:30 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:36:50 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:36:50 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:36:50 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:37:10 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:37:10 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:37:10 device.go:335: NHP-Server [Debug] packetToMsgRoutine 9: decrypting [NHP-AOL] raw packet
2025/04/21 05:37:10 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:37:10 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:AJN9+bkE2Ia5Y9nD3HpEMO6VlhKInOU+zW+lVlqV/Vge4GBRl/itTqLiFdApGQQLdr+6XYybUqE4OHSDgdCqpw==
2025/04/21 05:37:10 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:BZQquFydkOGUsRhodvKakDo3062WmMtUJau1Dzy6wTE=,NonceBytes:AAAAAAAAAAAAAABC,StaticBytes:R6yJZSoyZHS06+AKWDWtDlOvUGRkfYkdMltrVlP3IVFJnk9yNpw6QAOgsSMUIeBb5TKHYAFZtLEbN1U1HWcx5uLxuMofWo+hFm2hsTlYu4Y=
2025/04/21 05:37:10 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 9: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:37:10 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:37:10 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:37:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:37:10 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:37:10 transaction.go:229: NHP-Server [Debug] Remote transaction 66 start
2025/04/21 05:37:10 transaction.go:249: NHP-Server [Debug] Remote transaction 66 quit
2025/04/21 05:37:10 device.go:182: NHP-Server [Debug] msgToPacketRoutine 9: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:37:10 device.go:233: NHP-Server [Debug] msgToPacketRoutine 9: complete encrypting [NHP-AAK]
2025/04/21 05:37:10 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:37:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:37:10 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:37:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:37:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:37:31 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:37:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:37:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:37:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:38:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:38:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:38:11 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 05:38:11 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:38:11 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:4dCarf18r1rZ+5nr7vef8Gi5W+mdhXg8g39MX074iTEv5GyNqubwVAeuGyXXhc1SdSsOUQjaa+1WfEApjhG/Qg==
2025/04/21 05:38:11 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:64FIJZc9mdKdZrvWk/DTGIfW7E/zB/kNeAXMU7fuVnY=,NonceBytes:AAAAAAAAAAAAAABF,StaticBytes:61UPClBZu70hk0E7bs5my6A2kAr1hk8xKa5BXaRO+fcgeHMxshGcKhVfMBb7fRaSmiWLKlIYtb/qQy0UvB6F7Nl6onw9UEbdlmdGYatGO3s=
2025/04/21 05:38:11 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:38:11 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:38:11 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:38:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:38:11 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:38:11 transaction.go:229: NHP-Server [Debug] Remote transaction 69 start
2025/04/21 05:38:11 transaction.go:249: NHP-Server [Debug] Remote transaction 69 quit
2025/04/21 05:38:11 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:38:11 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AAK]
2025/04/21 05:38:11 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:38:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:38:11 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:38:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:38:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:38:31 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:38:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:38:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:38:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:39:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:39:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:39:11 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-AOL] raw packet
2025/04/21 05:39:11 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:39:11 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:bWcAURWb/H8e1XgAkqzx9EyYqRkNXKZefj2T4kKAC/0/Gcak7dqi8sSVZv6gch9s0XIDbgixBUCsjO4F7Gastg==
2025/04/21 05:39:11 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:eHcvPT2fIfyUjgOaJ/JfMxOUrcAbFZ4b/R2pHuY+Xas=,NonceBytes:AAAAAAAAAAAAAABI,StaticBytes:vUTN84kfmGc165uXUHfIf49gRa5Prm6hoAa1FZGgg+kSo6gt8etbQdtm/ivkas0xtKqBFWItsOFSaVOUViy6VzFDjS2s39fDms97x2ip8zs=
2025/04/21 05:39:11 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:39:11 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:39:11 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:39:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:39:11 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:39:11 transaction.go:229: NHP-Server [Debug] Remote transaction 72 start
2025/04/21 05:39:11 transaction.go:249: NHP-Server [Debug] Remote transaction 72 quit
2025/04/21 05:39:11 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:39:11 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AAK]
2025/04/21 05:39:11 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:39:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:39:11 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:39:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:39:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:39:31 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:39:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:39:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:39:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:40:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:40:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:40:11 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-AOL] raw packet
2025/04/21 05:40:11 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:40:11 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:q+P1NxWlf4CpiqDEuldBvkkEXIcoumMddAxsj5o70hziFQMCh8QDvi3dUjFgc3GM46EzLFw3qVj42L8W8JDpIw==
2025/04/21 05:40:11 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:4Vcz87bA2Yxi+bMyMVXD55Bdd+cADwf7tw7qJRjxtM0=,NonceBytes:AAAAAAAAAAAAAABL,StaticBytes:0ALDtRti1cSB+ouHjVdJaXSZjSjKJpFrdqqTGcV+R1B2MCysT+JYdTS9FF43QKW1up12V8vDE52i1Ukch9obgAyaXljDuiP2mzxSsC+3dZ8=
2025/04/21 05:40:11 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:40:11 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:40:11 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:40:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:40:11 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:40:11 transaction.go:229: NHP-Server [Debug] Remote transaction 75 start
2025/04/21 05:40:11 transaction.go:249: NHP-Server [Debug] Remote transaction 75 quit
2025/04/21 05:40:11 device.go:182: NHP-Server [Debug] msgToPacketRoutine 7: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:40:11 device.go:233: NHP-Server [Debug] msgToPacketRoutine 7: complete encrypting [NHP-AAK]
2025/04/21 05:40:11 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:40:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:40:11 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:40:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:40:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:40:31 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:40:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:40:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:40:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:41:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:41:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:41:11 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 05:41:11 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:41:11 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:RvSMaLmYIYLvoJPvtgcPup7IF+hjc2BmHCdWZuFMLDO5XKr30dxy2UbHbRPD6JLH5M//0j1/X64qxEmUvirXng==
2025/04/21 05:41:11 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:XcTCMN9ffyqAz0flFCV6FoeKtZZK8/25PcAIBaw6rQ4=,NonceBytes:AAAAAAAAAAAAAABO,StaticBytes:6Zd89nxRR4jWz5YMSLTMaR8vnAksUdA84hqBSZRvFSYJ5JjKIUTlsfH97nOSrgLIIQl8qgfjl6XrsQLOYftDajtxyA+qqVrEoMVCJwrKqCQ=
2025/04/21 05:41:11 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:41:11 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:41:11 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:41:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:41:11 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:41:11 transaction.go:229: NHP-Server [Debug] Remote transaction 78 start
2025/04/21 05:41:11 transaction.go:249: NHP-Server [Debug] Remote transaction 78 quit
2025/04/21 05:41:11 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:41:11 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AAK]
2025/04/21 05:41:11 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:41:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:41:11 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:41:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:41:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:41:31 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:41:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:41:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:41:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:42:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:42:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:42:11 device.go:335: NHP-Server [Debug] packetToMsgRoutine 4: decrypting [NHP-AOL] raw packet
2025/04/21 05:42:11 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:42:11 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:v2CgnowO91fJMBjglf40CFz6LTwUtT0IGQQiL7YrXT/Rbr2r6Z2xPWjRUgKgnCTIQL3E+R0xwwX35bOIBIb5JQ==
2025/04/21 05:42:11 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:6cH9zzHeMEeL9V6Xreiw0n/b94+BI8x58vU1L0k+66k=,NonceBytes:AAAAAAAAAAAAAABR,StaticBytes:+1gkTACLqCK8BX2M9tO1gd4TBgBz3P81oWngZ2g+rhw6GVfN5AeHBZDIwdJtob5wdl/BJLQSi5hHre6AOjaup5qgNLzuhhABe2jW6CmnBX0=
2025/04/21 05:42:11 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 4: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:42:11 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:42:11 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:42:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:42:11 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:42:11 transaction.go:229: NHP-Server [Debug] Remote transaction 81 start
2025/04/21 05:42:11 transaction.go:249: NHP-Server [Debug] Remote transaction 81 quit
2025/04/21 05:42:11 device.go:182: NHP-Server [Debug] msgToPacketRoutine 3: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:42:11 device.go:233: NHP-Server [Debug] msgToPacketRoutine 3: complete encrypting [NHP-AAK]
2025/04/21 05:42:11 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:42:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:42:11 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:42:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:42:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:42:31 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:42:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:42:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:42:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:43:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:43:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:43:11 device.go:335: NHP-Server [Debug] packetToMsgRoutine 5: decrypting [NHP-AOL] raw packet
2025/04/21 05:43:11 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:43:11 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:FhgC33sUMb2UG8AzG1Tu0mHOj8ccqZqco95UFO4ZjPZBvuxrO4bc0WVy6VmGcQHsNs/Zr1Rf57osJ2oeFTip3w==
2025/04/21 05:43:11 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:apsBAkmf2Ly9wN5jH9iejnO1g5cqaEOh4sP7jYKRzVo=,NonceBytes:AAAAAAAAAAAAAABU,StaticBytes:S/wnFQIm2wBKJOOmu2QcPx43WysSw6gW64HS2IcFOm/Q6LbVr+VkEiZYTG4uFiEFwrKM3lA81BNwpqE/mbzUFN0O+4J9JQqpUeY6/bFl7go=
2025/04/21 05:43:11 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 5: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:43:11 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:43:11 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:43:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:43:11 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:43:11 transaction.go:229: NHP-Server [Debug] Remote transaction 84 start
2025/04/21 05:43:11 transaction.go:249: NHP-Server [Debug] Remote transaction 84 quit
2025/04/21 05:43:11 device.go:182: NHP-Server [Debug] msgToPacketRoutine 4: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:43:11 device.go:233: NHP-Server [Debug] msgToPacketRoutine 4: complete encrypting [NHP-AAK]
2025/04/21 05:43:11 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:43:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:43:11 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:43:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:43:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:43:31 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:43:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:43:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:43:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:44:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:44:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:44:11 device.go:335: NHP-Server [Debug] packetToMsgRoutine 6: decrypting [NHP-AOL] raw packet
2025/04/21 05:44:11 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:44:11 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:8GPgRT/+okt4eeIbgNdcu4kxWxo4skn5wEF6SEbNJIck/HSBiINoL52S2yb4e6E5vXH0zAkUFsW+RBcfgBMI2w==
2025/04/21 05:44:11 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:e1D5o59gc1oFdNPCAl+2k6pUemp6EdHv51zPtMuUAiU=,NonceBytes:AAAAAAAAAAAAAABX,StaticBytes:EmOHM2VK+VzP3QAQwzsSDbo9zooqcpLi1Jj0T+7weZ/hGoLFWMmRjaJDsjX+p/ZTQIb9ddPIDSZpTlPlaUoOESkGuCA4YROMSwgbTNg7czc=
2025/04/21 05:44:11 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 6: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:44:11 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:44:11 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:44:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:44:11 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:44:11 transaction.go:229: NHP-Server [Debug] Remote transaction 87 start
2025/04/21 05:44:11 transaction.go:249: NHP-Server [Debug] Remote transaction 87 quit
2025/04/21 05:44:11 device.go:182: NHP-Server [Debug] msgToPacketRoutine 5: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:44:11 device.go:233: NHP-Server [Debug] msgToPacketRoutine 5: complete encrypting [NHP-AAK]
2025/04/21 05:44:11 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:44:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:44:11 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:44:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:44:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:44:31 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:44:33 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 05:44:33 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:44:33 | 200 |    7.691542ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 05:44:35 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 05:44:35 device.go:182: NHP-Server [Debug] msgToPacketRoutine 6: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"220.191.216.236","port":443}],"opnTime":20}
2025/04/21 05:44:35 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 05:44:35 device.go:233: NHP-Server [Debug] msgToPacketRoutine 6: complete encrypting [NHP-AOP]
2025/04/21 05:44:35 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 05:44:35 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:44:35 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 05:44:35 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:33896), 464 bytes
2025/04/21 05:44:35 transaction.go:138: NHP-Server [Debug] Local transaction 1 start
2025/04/21 05:44:35 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:33896 -> [::]:62206), 349 bytes
2025/04/21 05:44:35 udpserver.go:465: NHP-Server [Debug] Received udp packet len [349] from addr: 192.168.65.1:33896
2025/04/21 05:44:35 transaction.go:173: NHP-Server [Debug] Local transaction 1 quit
2025/04/21 05:44:35 device.go:335: NHP-Server [Debug] packetToMsgRoutine 7: decrypting [NHP-ART] raw packet
2025/04/21 05:44:35 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:A5mVVpZCRqB1+owcoVNULPeXhJbjuqIiNZI6PFS2zxTMUv1B25fqMFGpIW+l+Yj9lNUGGfXz7Fpw6gB/OWE+8Q==
2025/04/21 05:44:35 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:tDML/IzrJ+TB5luAbtn9m7BHzDZAUrEqIvH3aDdbC9I=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:QjmU4pwrqos72qitl3GXDHOe0R2IE3EsMUejv7rrK1gZd2rz9zjstvs1AeGcYRRwCHh3ROWLCL55HjdoobB+kvUeY9xru3/0yN7CWe88ZCY=
2025/04/21 05:44:35 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 7: complete decrypting [NHP-ART] message: {"errCode":"0","opnTime":20,"token":"eBBcmJOsQR66yI8XJhzG69PKpd96L/1DjRYQdbXsW1Y=","preAct":null}
2025/04/21 05:44:35 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 05:44:35 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 05:44:35 httpserver.go:402: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] succeed
2025/04/21 05:44:35 main.go:242: Plugin[example] [Info] knock succeeded.
2025/04/21 05:44:35 main.go:276: Plugin[example] [Info] ctx.SetCookie.
2025/04/21 05:44:35 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:44:35 | 200 |    33.06725ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 05:44:56 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:44:56 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:44:56 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:45:16 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:45:16 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:45:16 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:45:22 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 05:45:22 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:45:22 | 200 |      758.75µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 05:45:28 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 05:45:28 device.go:182: NHP-Server [Debug] msgToPacketRoutine 8: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"220.191.216.236","port":443}],"opnTime":20}
2025/04/21 05:45:28 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 05:45:28 device.go:233: NHP-Server [Debug] msgToPacketRoutine 8: complete encrypting [NHP-AOP]
2025/04/21 05:45:28 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 05:45:28 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:45:28 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 05:45:28 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:33896), 464 bytes
2025/04/21 05:45:28 transaction.go:138: NHP-Server [Debug] Local transaction 2 start
2025/04/21 05:45:28 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:33896 -> [::]:62206), 349 bytes
2025/04/21 05:45:28 udpserver.go:465: NHP-Server [Debug] Received udp packet len [349] from addr: 192.168.65.1:33896
2025/04/21 05:45:28 transaction.go:173: NHP-Server [Debug] Local transaction 2 quit
2025/04/21 05:45:28 device.go:335: NHP-Server [Debug] packetToMsgRoutine 8: decrypting [NHP-ART] raw packet
2025/04/21 05:45:28 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:ywQ411pU/q6s6hlgeeNJBPwK2uPS+yhAY250r48lAOCs8Do9mK5l9sdcm6yVJb5qg1iS+WwQHQyQGMR0ImuD1g==
2025/04/21 05:45:28 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:0zBo1sgBCkYMFhQxjD1AU1H7+QlF4wAmYDfNgT0pNFw=,NonceBytes:AAAAAAAAAAAAAAAC,StaticBytes:AW+YmMrpBL/8oJwsn8I/m39OXHecs34JolzzZw0iho0HYdQaDQ5W++H5KsmrsSRkGQpiyzmgnwpdbOuxttutwu7oKoVFZaD9amTjn/eSqaE=
2025/04/21 05:45:28 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 8: complete decrypting [NHP-ART] message: {"errCode":"0","opnTime":20,"token":"4upLe/IDBk44VNnlydgIz43heR1GrLppT+uNUW3TQJs=","preAct":null}
2025/04/21 05:45:28 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 05:45:28 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 05:45:28 httpserver.go:402: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] succeed
2025/04/21 05:45:28 main.go:242: Plugin[example] [Info] knock succeeded.
2025/04/21 05:45:28 main.go:276: Plugin[example] [Info] ctx.SetCookie.
2025/04/21 05:45:28 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:45:28 | 200 |   21.419917ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 05:45:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:45:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:45:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:46:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:46:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:46:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:46:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:46:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:46:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 9: decrypting [NHP-AOL] raw packet
2025/04/21 05:46:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:46:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:ut2OGLf2/GVhJEp7U2JgM6uLWsQrr/91L3WQToZ+rObHNqCQS+Wj2Ow0rfsGu/l7MJf65Tk/3uMAryNoM7ue4w==
2025/04/21 05:46:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:3Yko4LTzkOM0XxYEIku2kL5FDU1KJbx69zwbzjBqOwI=,NonceBytes:AAAAAAAAAAAAAABd,StaticBytes:6G0bwk+BFmSWujZlo2PkV98zeMPIW/J1Mohx7CGejDIAWsezaaNiWqFxmOGY5/E9qAnEkWJMlLoDjhrpjCag5X9LkJ+V+s+6w+bWDgRRNng=
2025/04/21 05:46:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 9: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:46:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:46:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:46:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:46:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:46:31 transaction.go:229: NHP-Server [Debug] Remote transaction 93 start
2025/04/21 05:46:31 transaction.go:249: NHP-Server [Debug] Remote transaction 93 quit
2025/04/21 05:46:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 9: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:46:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 9: complete encrypting [NHP-AAK]
2025/04/21 05:46:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:46:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:46:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:46:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:46:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:46:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:47:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:47:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:47:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:47:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:47:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:47:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 05:47:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:47:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:w1zynw5LP5k/3NRorapUzI1/DeSDksIm/R5RJVjzg2YfyZLljS9y3i6RTXpc061OaB7j37jqIVAMEKejBWZAlQ==
2025/04/21 05:47:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:0d3iICTw6jvhE0krdWvL1MO4N+2RSiEGN+6LE9DYadk=,NonceBytes:AAAAAAAAAAAAAABg,StaticBytes:LEHLnZ9sV1pxDozBT5XXfBXj6vzbjTTuPLe7EWHsMB/B/8MUmRS037CsjjmmKhDlLlGJvbZTkkCIaIKqbWPb32+UTGaCLaeTomFhvHi9ldU=
2025/04/21 05:47:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:47:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:47:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:47:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:47:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:47:31 transaction.go:229: NHP-Server [Debug] Remote transaction 96 start
2025/04/21 05:47:31 transaction.go:249: NHP-Server [Debug] Remote transaction 96 quit
2025/04/21 05:47:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:47:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AAK]
2025/04/21 05:47:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:47:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:47:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:47:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:47:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:47:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:48:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:48:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:48:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:48:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:48:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:48:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-AOL] raw packet
2025/04/21 05:48:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:48:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:Dx9TBaqBCCg9C5SPL+jXZhxhkK8bOGkckWs6IacipfzyGFcaVrEt9fq+UsNcafqfO6xz3uZLh41+pI5G8dyBbg==
2025/04/21 05:48:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:HD3m/gF89b9CYvLgIKIdBm8q3dUcNAdouQcI+uuwmNQ=,NonceBytes:AAAAAAAAAAAAAABj,StaticBytes:wehXiZMM2GABdWZ+Fkcv+ENLSe5cUuZLlGJpZWwx2/dZwZO0LkUHxpAS6q/cBtcewSNcBsIFN+9etmFWRp9pqmPoOZZTv8A22ej7IcXMnmQ=
2025/04/21 05:48:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:48:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:48:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:48:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:48:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:48:31 transaction.go:229: NHP-Server [Debug] Remote transaction 99 start
2025/04/21 05:48:31 transaction.go:249: NHP-Server [Debug] Remote transaction 99 quit
2025/04/21 05:48:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:48:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AAK]
2025/04/21 05:48:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:48:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:48:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:48:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:48:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:48:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:49:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:49:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:49:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:49:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:49:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:49:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-AOL] raw packet
2025/04/21 05:49:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:49:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:PHxG+UhVjN3X5YtqmH5BkCunZ0Kfy1SEgk1DdosMa46HEDMC/JUFilYVrhIiV5zGr61NlFr9lKXxCr7GT2CsPQ==
2025/04/21 05:49:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:oApBHUWr6Uz8NT0Lc1a1Hyq+f7088DvfTLq5jZW8a7M=,NonceBytes:AAAAAAAAAAAAAABm,StaticBytes:I2sGL8sTLdh3TSuWc7fE/O07mbuOFxFtpKoygKo6x2MoH6+IKkZKiY7Jzd54jVv21z7Ll0hRSkP4QGoT0ld18JFZgEA8NfjFGeM8FWVygc0=
2025/04/21 05:49:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:49:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:49:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:49:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:49:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:49:31 transaction.go:229: NHP-Server [Debug] Remote transaction 102 start
2025/04/21 05:49:31 transaction.go:249: NHP-Server [Debug] Remote transaction 102 quit
2025/04/21 05:49:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 7: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:49:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 7: complete encrypting [NHP-AAK]
2025/04/21 05:49:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:49:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:49:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:49:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:49:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:49:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:50:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:33896 -> [::]:62206), 160 bytes
2025/04/21 05:50:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:33896
2025/04/21 05:50:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:33896 -> [::]:62206)
2025/04/21 05:50:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:33896 -> [::]:62206), 293 bytes
2025/04/21 05:50:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:33896
2025/04/21 05:50:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 05:50:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:50:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:6S2ZcBbbTRxFqhY789BB2Oo9WPk7EwrwYhbe7DNL3s1WqeD7T8ToFdtyvAiIdOTsShsdAFhnZECygcXLP6Q7NQ==
2025/04/21 05:50:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:+EkcW64xRnng3g0Fmsbsx8F2yLPJ9+dE+9AlPZfcRjE=,NonceBytes:AAAAAAAAAAAAAABp,StaticBytes:UTY8rEGUQzmPKIci8EJNg7mu8EEfYv0yU0K/3b0SdKYWUOvJoGVTzfO8JacUKwSMx/Ss/BezE+0Ss1OfT2ScVK29nYnhLmMKgFSPrIiOpL0=
2025/04/21 05:50:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:50:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:50:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:50:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:50:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:50:31 transaction.go:229: NHP-Server [Debug] Remote transaction 105 start
2025/04/21 05:50:31 transaction.go:249: NHP-Server [Debug] Remote transaction 105 quit
2025/04/21 05:50:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:33896"}
2025/04/21 05:50:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AAK]
2025/04/21 05:50:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:50:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:50:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:33896), 297 bytes
2025/04/21 05:50:57 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 05:50:57 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421035448 started              ===
2025/04/21 05:50:57 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 05:50:57 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:54:48                       ===
2025/04/21 05:50:57 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 05:50:57 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 05:50:57 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 05:50:57 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 05:50:57 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 05:50:57 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 05:50:57 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 05:50:57) started  ===
2025/04/21 05:50:57 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 05:50:57 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 05:50:57 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 05:50:57 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 05:50:57 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 05:50:57 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 05:50:57 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 05:50:57 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 05:50:57 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 05:50:57 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 05:50:57 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 05:50:57 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 05:50:57 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 05:50:57 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 05:50:57 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 05:50:57 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 05:50:57 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 05:50:57 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 05:50:57 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 05:50:57 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 05:50:57 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 05:50:57 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 05:50:57 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 05:50:57 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 05:50:57 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 05:50:57 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 05:50:57 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 05:50:57 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 05:50:57 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 05:50:57 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 05:50:57 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 05:50:57 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 05:50:57 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 05:50:57 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 05:50:57 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 05:50:57 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 05:50:57 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 05:51:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:51:11 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:23882 to [::]:62206
2025/04/21 05:51:11 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:23882 started
2025/04/21 05:51:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:51:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:51:18 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 05:51:18 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:51:18 | 200 |    5.345625ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 05:51:20 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 05:51:20 httpserver.go:365: NHP-Server [Error] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)-ac(@testAC-1)[HandleHttpKnockRequest] no ac connection is available
2025/04/21 05:51:20 main.go:237: Plugin[example] [Error] knock failed. ackMsg is nil
2025/04/21 05:51:20 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:51:20 | 200 |     865.625µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 05:51:23 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 05:51:23 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:51:23 | 200 |      836.75µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 05:51:24 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 05:51:24 httpserver.go:365: NHP-Server [Error] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)-ac(@testAC-1)[HandleHttpKnockRequest] no ac connection is available
2025/04/21 05:51:24 main.go:237: Plugin[example] [Error] knock failed. ackMsg is nil
2025/04/21 05:51:24 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:51:24 | 200 |     185.917µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 05:51:27 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 05:51:27 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:51:27 | 200 |     353.917µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 05:51:29 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 05:51:29 httpserver.go:365: NHP-Server [Error] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)-ac(@testAC-1)[HandleHttpKnockRequest] no ac connection is available
2025/04/21 05:51:29 main.go:237: Plugin[example] [Error] knock failed. ackMsg is nil
2025/04/21 05:51:29 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:51:29 | 200 |     121.083µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 05:51:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:23882 -> [::]:62206), 293 bytes
2025/04/21 05:51:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:23882
2025/04/21 05:51:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-AOL] raw packet
2025/04/21 05:51:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:51:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:QaV7/K2dI9XwfSFFedHBg+3QUtBPC9vl1yKKlc+Ff5nrSanClHlwpkYyOfl5WOlqh/kZ356RWKCdYqv3t80/Fw==
2025/04/21 05:51:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:89TvDM5B4bf0LwW7wjnuyjGyKt1FMOqjHaKGs+17o/4=,NonceBytes:AAAAAAAAAAAAAABs,StaticBytes:jvvlgcXWHfSXjMLM0rIkWWopxfDk967ODHi481Q/wJCmsQFAeU0D7GutJS4b67YNhH/w7GkpVpcfVE/gR0qGAGFATtfFol+i0OBlSs6zX3A=
2025/04/21 05:51:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:51:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:51:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:51:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:51:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:51:31 transaction.go:229: NHP-Server [Debug] Remote transaction 108 start
2025/04/21 05:51:31 transaction.go:249: NHP-Server [Debug] Remote transaction 108 quit
2025/04/21 05:51:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 5: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:23882"}
2025/04/21 05:51:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 5: complete encrypting [NHP-AAK]
2025/04/21 05:51:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:51:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:51:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:23882), 297 bytes
2025/04/21 05:51:33 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 05:51:33 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:51:33 | 200 |     132.584µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 05:51:34 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 05:51:34 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:51:34 | 200 |     157.875µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 05:51:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:51:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:51:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:52:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:52:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:52:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:52:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:23882 -> [::]:62206), 293 bytes
2025/04/21 05:52:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:23882
2025/04/21 05:52:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 05:52:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:52:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:hnjueByaGgXCWzCF6mH5eiQuw1Cwcbob45xX6vupHflE5ddK7NaFkXqg+YdLtCexF7pKxaICNTYgtV5jBvwtAQ==
2025/04/21 05:52:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:+r8YizunlEcApdFW04a//KkV2vWfMVStbrsZRaH9h9g=,NonceBytes:AAAAAAAAAAAAAABv,StaticBytes:+A2N9pHTQKt1c74L/8+IzIaDPrx88e7IufLn4dhfu7dPctT5LWkGr59Jdg/gSgyU9SFicN7hqKNeQtPnrHJmuUDjERthkas08ZeR4P9djUA=
2025/04/21 05:52:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:52:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:52:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:52:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:52:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:52:31 transaction.go:229: NHP-Server [Debug] Remote transaction 111 start
2025/04/21 05:52:31 transaction.go:249: NHP-Server [Debug] Remote transaction 111 quit
2025/04/21 05:52:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:23882"}
2025/04/21 05:52:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AAK]
2025/04/21 05:52:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:52:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:52:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:23882), 297 bytes
2025/04/21 05:52:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:52:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:52:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:53:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:53:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:53:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:53:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:23882 -> [::]:62206), 293 bytes
2025/04/21 05:53:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:23882
2025/04/21 05:53:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 4: decrypting [NHP-AOL] raw packet
2025/04/21 05:53:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:53:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:68cDrS0O71iP2dGmf0QkiekhS1hBNmTD/LT0Ert8RPK9ltj5Rh6dH4It5HfMHuHDAufbN0OiyXe/otPLHKcIYw==
2025/04/21 05:53:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:HKU2YdymO9/O9jz9zu2jbSH3dpmjoII/Sb0pDyDXFIA=,NonceBytes:AAAAAAAAAAAAAABy,StaticBytes:dRw7UwhfaTjXT1kvWwx4vNkX+vb4FM15kqhmFgPumeSEloJve83WweTUOiHssNog7/J1JTw41FGirsKap7KbnOpcPaOj3uV8LkDeFQQ4ygM=
2025/04/21 05:53:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 4: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:53:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:53:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:53:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:53:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:53:31 transaction.go:229: NHP-Server [Debug] Remote transaction 114 start
2025/04/21 05:53:31 transaction.go:249: NHP-Server [Debug] Remote transaction 114 quit
2025/04/21 05:53:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 3: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:23882"}
2025/04/21 05:53:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 3: complete encrypting [NHP-AAK]
2025/04/21 05:53:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:53:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:53:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:23882), 297 bytes
2025/04/21 05:53:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:53:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:53:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:54:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:54:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:54:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:54:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:23882 -> [::]:62206), 293 bytes
2025/04/21 05:54:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:23882
2025/04/21 05:54:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 5: decrypting [NHP-AOL] raw packet
2025/04/21 05:54:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:54:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:sD9OvXUTIfP2EDFu8miEuQLaHtGiJtUFzMkdz2hjrHQkuFxvvcL4q15Cy6c0trtNGYTuVpJQVP4U3Z3ryAACpQ==
2025/04/21 05:54:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:Tt+vQiFL3GhNhEOMn1hpTURMbJwMY2/klhnyvx60jFI=,NonceBytes:AAAAAAAAAAAAAAB1,StaticBytes:RpX66Qbln7QqNOo5ZFUHOeB0koQOuPfN9ECpj2G929DKolsZsD35WTJzYlLQgpxbQRtCqYJbbO5o2teweX8GXFcpcfPUDgDaBnsjC9aSyPI=
2025/04/21 05:54:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 5: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:54:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:54:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:54:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:54:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:54:31 transaction.go:229: NHP-Server [Debug] Remote transaction 117 start
2025/04/21 05:54:31 transaction.go:249: NHP-Server [Debug] Remote transaction 117 quit
2025/04/21 05:54:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 4: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:23882"}
2025/04/21 05:54:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 4: complete encrypting [NHP-AAK]
2025/04/21 05:54:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:54:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:54:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:23882), 297 bytes
2025/04/21 05:54:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:54:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:54:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:55:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:55:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:55:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:55:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:23882 -> [::]:62206), 293 bytes
2025/04/21 05:55:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:23882
2025/04/21 05:55:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 6: decrypting [NHP-AOL] raw packet
2025/04/21 05:55:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:55:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:pTCYd4GOYs7Htbf2RXJcJ3NUAaIhYxkbVJt+tMOjoLLwNQdN5GZsU1n29aGXu3/4CTN40OIzOFobYSM/lc8BmQ==
2025/04/21 05:55:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:hJsWAc/HiDvotYXXCARo+cbi2RrAz+FkN5BFtFTRqmw=,NonceBytes:AAAAAAAAAAAAAAB4,StaticBytes:XqU4UFvr4X8puMviU6wZZrK9pybYX3wkFO3xXiuT8hukaDywMJZhW4V9vH68rm+MNkKvD9xjHLd1g+CjRYpqXQ8pA5KyzO7cAbWqfKVWU28=
2025/04/21 05:55:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 6: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:55:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:55:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:55:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:55:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:55:31 transaction.go:229: NHP-Server [Debug] Remote transaction 120 start
2025/04/21 05:55:31 transaction.go:249: NHP-Server [Debug] Remote transaction 120 quit
2025/04/21 05:55:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 9: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:23882"}
2025/04/21 05:55:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 9: complete encrypting [NHP-AAK]
2025/04/21 05:55:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:55:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:55:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:23882), 297 bytes
2025/04/21 05:55:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:55:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:55:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:56:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:56:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:56:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:56:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:23882 -> [::]:62206), 293 bytes
2025/04/21 05:56:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:23882
2025/04/21 05:56:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 7: decrypting [NHP-AOL] raw packet
2025/04/21 05:56:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:56:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:hRyWn+hpFcEHPpvpbM6uMYN96bRoPgxUHM4SF6H3pdaEDXuQDbxVsOmlyB/yWi7DvMFnp4Y1pz6J/Q7vU3n9ZQ==
2025/04/21 05:56:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:/1YHaza+CNWm0b/2cLjs+UwOmrgHrX9aK01cstlaaII=,NonceBytes:AAAAAAAAAAAAAAB7,StaticBytes:7sYsuxQREUtv0CZi2KVmOenhKnAlSjiIYhpb32G8nODTzaSG3DssBibNkJe/NHA04lkD1EE48yCb+mMc6s0+MAhQaVgxaFgO7B1WEx/6EJ4=
2025/04/21 05:56:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 7: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:56:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:56:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:56:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:56:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:56:31 transaction.go:229: NHP-Server [Debug] Remote transaction 123 start
2025/04/21 05:56:31 transaction.go:249: NHP-Server [Debug] Remote transaction 123 quit
2025/04/21 05:56:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 6: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:23882"}
2025/04/21 05:56:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 6: complete encrypting [NHP-AAK]
2025/04/21 05:56:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:56:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:56:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:23882), 297 bytes
2025/04/21 05:56:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:56:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:56:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:57:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:23882 -> [::]:62206), 160 bytes
2025/04/21 05:57:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:23882
2025/04/21 05:57:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:23882 -> [::]:62206)
2025/04/21 05:57:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:23882 -> [::]:62206), 293 bytes
2025/04/21 05:57:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:23882
2025/04/21 05:57:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 8: decrypting [NHP-AOL] raw packet
2025/04/21 05:57:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:57:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:aP3KjDEpowye//reDMmxuoFFl1t2E3t0CY3FZ7yeqAzGqqBCJ5Sf/bOk42v5d+0VCpDjeKHcMXSHj6KiRWSTSQ==
2025/04/21 05:57:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:A5TEg7tghNZTlv5SXFaPtaShL89gzAI99YzeBbYrS9A=,NonceBytes:AAAAAAAAAAAAAAB+,StaticBytes:7+wVwEH3TbVptnNvLRCdKc+NwFZR9l8YPec4qk6b59A6ne0kemb2LN/MOlAR6CDE+5rujxhxAHSXDv+7Zx5aBbk9bGM/9fpeBoU+LjY6KoQ=
2025/04/21 05:57:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 8: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:57:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:57:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:57:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:57:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:57:31 transaction.go:229: NHP-Server [Debug] Remote transaction 126 start
2025/04/21 05:57:31 transaction.go:249: NHP-Server [Debug] Remote transaction 126 quit
2025/04/21 05:57:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 7: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:23882"}
2025/04/21 05:57:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 7: complete encrypting [NHP-AAK]
2025/04/21 05:57:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:57:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:57:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:23882), 297 bytes
2025/04/21 05:58:12 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 05:58:12 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421035448 started              ===
2025/04/21 05:58:12 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 05:58:12 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:54:48                       ===
2025/04/21 05:58:12 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 05:58:12 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 05:58:12 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 05:58:12 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 05:58:12 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 05:58:12 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 05:58:12 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 05:58:12) started  ===
2025/04/21 05:58:12 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 05:58:12 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 05:58:12 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 05:58:12 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 05:58:12 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 05:58:12 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 05:58:12 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 05:58:12 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 05:58:12 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 05:58:12 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 05:58:12 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 05:58:12 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 05:58:12 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 05:58:12 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 05:58:12 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 05:58:12 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 05:58:12 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 05:58:12 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 05:58:12 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 05:58:12 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 05:58:12 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 05:58:12 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 05:58:12 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 05:58:12 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 05:58:12 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 05:58:12 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 05:58:12 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 05:58:12 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 05:58:12 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 05:58:12 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 05:58:12 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 05:58:12 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 05:58:12 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 05:58:12 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 05:58:12 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 05:58:12 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 05:58:12 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 05:58:12 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:54410 -> [::]:62206), 293 bytes
2025/04/21 05:58:12 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:54410
2025/04/21 05:58:12 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:54410 to [::]:62206
2025/04/21 05:58:12 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:54410 started
2025/04/21 05:58:12 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:54410
2025/04/21 05:58:12 device.go:335: NHP-Server [Debug] packetToMsgRoutine 4: decrypting [NHP-AOL] raw packet
2025/04/21 05:58:12 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:58:12 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:CLKAaaEY5PEgIup4ekv6TN4VNsTBeQfa6u21MY8q8p3lA5ArwxxExEdU1/1n7FgBJWkRalbQAQJc1k82VyKk4Q==
2025/04/21 05:58:12 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:PlhV5eTH2gYfuY4CcUVtiE4wAsiKyDKrLFrbjY5yJ6Q=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:B708lkYS8YNYQMKapSk8yCT6w25okHI6vbD1k6LzF3LYS9MR4BgLyKoaFjDw2V5G98/UcTCCCnCANoY/oqy3/cdgvFq5QQ2N0VraQVpkkWs=
2025/04/21 05:58:12 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 4: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:58:12 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:58:12 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:58:12 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:58:12 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:58:12 transaction.go:229: NHP-Server [Debug] Remote transaction 1 start
2025/04/21 05:58:12 transaction.go:249: NHP-Server [Debug] Remote transaction 1 quit
2025/04/21 05:58:12 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:54410"}
2025/04/21 05:58:12 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AAK]
2025/04/21 05:58:12 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:58:12 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:58:12 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:54410), 297 bytes
2025/04/21 05:58:28 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 05:58:28 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:58:28 | 200 |    2.050459ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 05:58:32 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:54410 -> [::]:62206), 160 bytes
2025/04/21 05:58:32 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:54410
2025/04/21 05:58:32 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:54410 -> [::]:62206)
2025/04/21 05:58:52 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:54410 -> [::]:62206), 160 bytes
2025/04/21 05:58:52 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:54410
2025/04/21 05:58:52 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:54410 -> [::]:62206)
2025/04/21 05:58:59 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 05:58:59 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:58:59 | 200 |    2.057417ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 05:59:01 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 05:59:01 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"220.191.216.236","port":443}],"opnTime":20}
2025/04/21 05:59:01 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 05:59:01 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AOP]
2025/04/21 05:59:01 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 05:59:01 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:59:01 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 05:59:01 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:54410), 464 bytes
2025/04/21 05:59:01 transaction.go:138: NHP-Server [Debug] Local transaction 1 start
2025/04/21 05:59:06 transaction.go:194: NHP-Server [Warning] Local transaction 1 stopped due to timeout
2025/04/21 05:59:06 transaction.go:196: NHP-Server [Debug] Local transaction 1 quit
2025/04/21 05:59:06 udpserver.go:835: NHP-Server [Error] server-agent(@192.168.65.1)-ac(testAC-1#1@192.168.65.1:54410)[processACOperation] failed to receive response from ac: transaction failed due to time out
2025/04/21 05:59:06 httpserver.go:395: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] failed: map[demoServer:0x4000083300]
2025/04/21 05:59:06 main.go:237: Plugin[example] [Error] knock failed. ackMsg is nil
2025/04/21 05:59:06 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 05:59:06 | 200 |  4.710244544s |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 05:59:06 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 05:59:06 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"220.191.216.236","port":443}],"opnTime":20}
2025/04/21 05:59:06 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 05:59:06 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AOP]
2025/04/21 05:59:06 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 05:59:06 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:59:06 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 05:59:06 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:54410), 464 bytes
2025/04/21 05:59:06 transaction.go:138: NHP-Server [Debug] Local transaction 2 start
2025/04/21 05:59:10 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 05:59:10 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421035448 started              ===
2025/04/21 05:59:10 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 05:59:10 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:54:48                       ===
2025/04/21 05:59:10 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 05:59:10 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 05:59:10 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 05:59:10 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 05:59:10 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 05:59:10 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 05:59:10 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 05:59:10) started  ===
2025/04/21 05:59:10 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 05:59:10 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 05:59:10 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 05:59:10 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 05:59:10 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 05:59:10 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 05:59:10 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 05:59:10 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 05:59:10 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 05:59:10 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 05:59:10 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 05:59:10 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 05:59:10 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 05:59:10 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 05:59:10 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 05:59:10 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 05:59:10 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 05:59:10 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 05:59:10 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 05:59:10 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 05:59:10 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 05:59:10 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 05:59:10 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 05:59:10 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 05:59:10 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 05:59:10 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 05:59:10 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 05:59:10 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 05:59:10 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 05:59:10 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 05:59:10 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 05:59:10 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 05:59:10 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 05:59:10 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 05:59:10 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 05:59:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:17383 -> [::]:62206), 293 bytes
2025/04/21 05:59:11 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:17383
2025/04/21 05:59:11 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:17383 to [::]:62206
2025/04/21 05:59:11 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:17383 started
2025/04/21 05:59:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:17383
2025/04/21 05:59:11 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 05:59:11 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 05:59:11 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:aLlQ94BG0Anz7Fyqa/p2h+mMku3UmBskzTyykgPPpiuqnCosJd02MgD5RwAoMdiaYLhaTmv+gikHJIzkaZMyeQ==
2025/04/21 05:59:11 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:W3uMF77zGGGmAqQDOtO6Pq750C1T1YGtfGE9xX1yIWE=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:e+3Gw1IjlaCxhN77+/y/6ZLOOUTzlG4FcBHjP+aQ4JqYsr/PR2T7KcRvqJd/vk+/7M/kVu1rCOA+PYymskOZzv2K/Nb2uKIfPPazTBAN6Xc=
2025/04/21 05:59:11 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 05:59:11 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 05:59:11 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 05:59:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:59:11 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 05:59:11 transaction.go:229: NHP-Server [Debug] Remote transaction 1 start
2025/04/21 05:59:11 transaction.go:249: NHP-Server [Debug] Remote transaction 1 quit
2025/04/21 05:59:11 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:17383"}
2025/04/21 05:59:11 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AAK]
2025/04/21 05:59:11 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 05:59:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 05:59:11 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:17383), 297 bytes
2025/04/21 05:59:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:17383 -> [::]:62206), 160 bytes
2025/04/21 05:59:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:17383
2025/04/21 05:59:31 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:17383 -> [::]:62206)
2025/04/21 05:59:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:17383 -> [::]:62206), 160 bytes
2025/04/21 05:59:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:17383
2025/04/21 05:59:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:17383 -> [::]:62206)
2025/04/21 06:00:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:17383 -> [::]:62206), 293 bytes
2025/04/21 06:00:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:17383
2025/04/21 06:00:11 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-AOL] raw packet
2025/04/21 06:00:11 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:00:11 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:pCWEQpxvjEQ3lXrWn2D20CVDbVBk5R6exxrLbXBOYQJWDuGniBMXNbLovOILFThzwWnMlkt37W2Tii9dnnNsPg==
2025/04/21 06:00:11 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:CjztB8KNyLgXNP/MdVTr9ksG+yMeRiCwFVBRtfGL/tg=,NonceBytes:AAAAAAAAAAAAAAAE,StaticBytes:3CsBzuNQcxFVfzH6x7Cm+cUycna5PFnN02IYzXHTvvvoRBs6vHjZ0jTMk3/Ub0dCO4txjqJwAqh1/YqLBq09pUFxCdC9Jj4p/z6qnWWUZRI=
2025/04/21 06:00:11 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:00:11 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:00:11 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:00:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:00:11 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:00:11 transaction.go:229: NHP-Server [Debug] Remote transaction 4 start
2025/04/21 06:00:11 transaction.go:249: NHP-Server [Debug] Remote transaction 4 quit
2025/04/21 06:00:11 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:17383"}
2025/04/21 06:00:11 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AAK]
2025/04/21 06:00:11 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:00:11 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:00:11 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:17383), 297 bytes
2025/04/21 06:00:30 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 06:00:30 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"220.191.216.236","port":443}],"opnTime":20}
2025/04/21 06:00:30 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 06:00:30 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AOP]
2025/04/21 06:00:30 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 06:00:30 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:00:30 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 06:00:30 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:17383), 464 bytes
2025/04/21 06:00:30 transaction.go:138: NHP-Server [Debug] Local transaction 1 start
2025/04/21 06:00:30 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:17383 -> [::]:62206), 349 bytes
2025/04/21 06:00:30 udpserver.go:465: NHP-Server [Debug] Received udp packet len [349] from addr: 192.168.65.1:17383
2025/04/21 06:00:30 transaction.go:173: NHP-Server [Debug] Local transaction 1 quit
2025/04/21 06:00:30 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-ART] raw packet
2025/04/21 06:00:30 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:F271ZdAI6Q3DxYCkAekJ/QPy8gxQlTrjVp7avzZe0T4iDI/hBsdzyxZHSKAeR1ynWJrWyOHGOGUXBtSOsPC4tA==
2025/04/21 06:00:30 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:8654eu54gjfmcNLbRV7OB958IZ/nXn/L1n7EVYCdT2c=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:I5uZBTJAN82OHlDkMgBdv9WnNeszdPEwPlenOallRn+Uh4JjO8mO17+s9s1Tx1oupqKLup2HeX44gfLdTrmY1ad3c03a6Y8C1eCQYkhmR6M=
2025/04/21 06:00:30 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-ART] message: {"errCode":"0","opnTime":20,"token":"yZFj09z8axhJHQc0JpFy6FJ98YSspu+26W29iszAMc0=","preAct":null}
2025/04/21 06:00:30 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 06:00:30 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 06:00:30 httpserver.go:402: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] succeed
2025/04/21 06:00:30 main.go:242: Plugin[example] [Info] knock succeeded.
2025/04/21 06:00:30 main.go:276: Plugin[example] [Info] ctx.SetCookie.
2025/04/21 06:00:30 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:00:30 | 200 |    23.14475ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 06:00:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:17383 -> [::]:62206), 160 bytes
2025/04/21 06:00:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:17383
2025/04/21 06:00:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:17383 -> [::]:62206)
2025/04/21 06:01:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:17383 -> [::]:62206), 160 bytes
2025/04/21 06:01:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:17383
2025/04/21 06:01:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:17383 -> [::]:62206)
2025/04/21 06:01:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:17383 -> [::]:62206), 293 bytes
2025/04/21 06:01:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:17383
2025/04/21 06:01:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 06:01:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:01:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:i4Gr3ezey5KKAVWPHUQDCMlGudelZlZq1DubXUlXTes5u/r66Js3yKWwkMkkD3dc4oE5CqRLgAVpMrDPDYe/uQ==
2025/04/21 06:01:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:ITu1ZU320VkZWgNWF1m4XTsiDwrwOrARSmMeCM15hmk=,NonceBytes:AAAAAAAAAAAAAAAH,StaticBytes:Pk4yc3FANN30m9D/SeOWfBQrwjRGJLAFIU2snOvoQ5ZR/4aqNR6Nkw+dc1hEAK/sMwtVEG7Q6fYXFBD3OyP6tfS6L07oZsIhaMbAAl47Jkg=
2025/04/21 06:01:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:01:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:01:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:01:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:01:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:01:31 transaction.go:229: NHP-Server [Debug] Remote transaction 7 start
2025/04/21 06:01:31 transaction.go:249: NHP-Server [Debug] Remote transaction 7 quit
2025/04/21 06:01:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 3: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:17383"}
2025/04/21 06:01:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 3: complete encrypting [NHP-AAK]
2025/04/21 06:01:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:01:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:01:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:17383), 297 bytes
2025/04/21 06:01:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:17383 -> [::]:62206), 160 bytes
2025/04/21 06:01:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:17383
2025/04/21 06:01:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:17383 -> [::]:62206)
2025/04/21 06:02:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:17383 -> [::]:62206), 160 bytes
2025/04/21 06:02:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:17383
2025/04/21 06:02:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:17383 -> [::]:62206)
2025/04/21 06:02:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:17383 -> [::]:62206), 293 bytes
2025/04/21 06:02:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:17383
2025/04/21 06:02:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 4: decrypting [NHP-AOL] raw packet
2025/04/21 06:02:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:02:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:QMXwW2dChLuMpn/v2Z7cIkIn2QIxfSM8GAELbjQMHxR1y0Nni4Zvw1qRLszoDA9ZqfJqhFxCi8Z4433dwlidww==
2025/04/21 06:02:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:APDJUh6kJdM9GkT/RP+9GAwqRXue0ZTZxFA8x0kzw1U=,NonceBytes:AAAAAAAAAAAAAAAK,StaticBytes:AUBR2yK/zvve1yGoOEaqMq/aPSbFTi4MhjIi/JFquHpaKSCFQsnZH5i7pmiS+WnL3Hx81TnROw3iDCns5YDCEY9CRlUbQ9+RneJrj5qkl0s=
2025/04/21 06:02:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 4: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:02:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:02:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:02:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:02:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:02:31 transaction.go:229: NHP-Server [Debug] Remote transaction 10 start
2025/04/21 06:02:31 transaction.go:249: NHP-Server [Debug] Remote transaction 10 quit
2025/04/21 06:02:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 4: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:17383"}
2025/04/21 06:02:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 4: complete encrypting [NHP-AAK]
2025/04/21 06:02:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:02:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:02:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:17383), 297 bytes
2025/04/21 06:02:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:17383 -> [::]:62206), 160 bytes
2025/04/21 06:02:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:17383
2025/04/21 06:02:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:17383 -> [::]:62206)
2025/04/21 06:02:54 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] runtime error: invalid memory address or nil pointer dereference
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] goroutine 114 [running]:
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] runtime/debug.Stack()
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	runtime/debug/stack.go:26 +0x64
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/nhp/utils.CatchPanic()
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/nhp@v0.5.0/utils/utils.go:26 +0x50
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] panic({0xe14ba0?, 0x14d1220?})
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	runtime/panic.go:792 +0x124
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).HTML(0x40001b2400, 0xc8, {0xffff3f868a4c?, 0x5?}, {0xe60ea0?, 0x400059eab0?})
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:971 +0x38
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] plugin/unnamed-fb91a1b7bf02861df8d35b30214716de1d61b84c.authAndShowLogin(0x40001b2400, 0x40001564d0, 0x400062c000, 0x90a744?)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	./main.go:214 +0x24c
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] plugin/unnamed-fb91a1b7bf02861df8d35b30214716de1d61b84c.AuthWithHttp(0x40001b2400, 0x40001564d0, 0x400050a370)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	./main.go:196 +0x1a0
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/nhp/plugins.(*PluginHandlerSymbol).AuthWithHttp(0x4000a675c8?, 0x40000ea0cd?, 0x10d00000010?, 0xffff543806e8?)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/nhp@v0.5.0/plugins/serverpluginhandler.go:132 +0x70
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/endpoints/server.(*HttpServer).authWithAspPlugin(0x4000022be0, 0x40001b2400, 0x40001564d0)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/endpoints/server/httpauth.go:24 +0xe8
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/endpoints/server.(*HttpServer).initRouter.func1(0x40001b2400)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/endpoints/server/httpserver.go:224 +0x350
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(...)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.CustomRecoveryWithWriter.func1(0x40001b2400)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/recovery.go:102 +0x78
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(...)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.LoggerWithConfig.func1(0x40001b2400)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/logger.go:249 +0xb4
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(0x40001b2400)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185 +0x3c
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/endpoints/server.(*HttpServer).Start.corsMiddleware.func3(0x40001b2400)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/endpoints/server/httpserver.go:306 +0x264
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(...)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Engine).handleHTTPRequest(0x4000634340, 0x40001b2400)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/gin.go:633 +0x6c4
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Engine).ServeHTTP(0x4000634340, {0x1021218, 0x400024c1c0}, 0x40000b6140)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/gin.go:589 +0x170
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] net/http.serverHandler.ServeHTTP({0x4000122b10?}, {0x1021218?, 0x400024c1c0?}, 0x6?)
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	net/http/server.go:3301 +0xbc
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] net/http.(*conn).serve(0x40007be000, {0x10223a0, 0x40004eec30})
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	net/http/server.go:2102 +0x52c
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] created by net/http.(*Server).Serve in goroutine 66
2025/04/21 06:02:54 utils.go:28: NHP-Server [Error] 	net/http/server.go:3454 +0x3d8
2025/04/21 06:02:54 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:02:54 | 200 |    1.475042ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:03:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:17383 -> [::]:62206), 160 bytes
2025/04/21 06:03:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:17383
2025/04/21 06:03:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:17383 -> [::]:62206)
2025/04/21 06:03:31 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:17383 -> [::]:62206), 293 bytes
2025/04/21 06:03:31 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:17383
2025/04/21 06:03:31 device.go:335: NHP-Server [Debug] packetToMsgRoutine 5: decrypting [NHP-AOL] raw packet
2025/04/21 06:03:31 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:03:31 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:UeafqxFmFOlH3GdSVwwAOh0kelgbNza7JFJOVEUYMC2KU5TEPMze0raQJ1jxHFGJTFFMhf7iHGu72yxMt9iagw==
2025/04/21 06:03:31 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:yMJzdRwp8CUb6Xr/h65PsI1wcY3JtJLwKBfd0pC8Ras=,NonceBytes:AAAAAAAAAAAAAAAN,StaticBytes:/t9VoN3HFQfYQ3iSd0mM+j8bo4DM8rF4li1QbPtvnTT1LL3kLeKQJ+XRdQJmEgbBfHO3mTgIOpCbjC+GPWkPxqNfWnr9VYgYUihL2WKfKOw=
2025/04/21 06:03:31 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 5: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:03:31 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:03:31 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:03:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:03:31 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:03:31 transaction.go:229: NHP-Server [Debug] Remote transaction 13 start
2025/04/21 06:03:31 transaction.go:249: NHP-Server [Debug] Remote transaction 13 quit
2025/04/21 06:03:31 device.go:182: NHP-Server [Debug] msgToPacketRoutine 5: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:17383"}
2025/04/21 06:03:31 device.go:233: NHP-Server [Debug] msgToPacketRoutine 5: complete encrypting [NHP-AAK]
2025/04/21 06:03:31 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:03:31 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:03:31 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:17383), 297 bytes
2025/04/21 06:03:43 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] runtime error: invalid memory address or nil pointer dereference
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] goroutine 101 [running]:
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] runtime/debug.Stack()
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	runtime/debug/stack.go:26 +0x64
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/nhp/utils.CatchPanic()
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/nhp@v0.5.0/utils/utils.go:26 +0x50
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] panic({0xe14ba0?, 0x14d1220?})
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	runtime/panic.go:792 +0x124
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).HTML(0x400025a400, 0xc8, {0xffff3f868a4c?, 0x5?}, {0xe60ea0?, 0x40004ef200?})
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:971 +0x38
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] plugin/unnamed-fb91a1b7bf02861df8d35b30214716de1d61b84c.authAndShowLogin(0x400025a400, 0x4000a8a0b0, 0x400062c000, 0x90a744?)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	./main.go:214 +0x24c
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] plugin/unnamed-fb91a1b7bf02861df8d35b30214716de1d61b84c.AuthWithHttp(0x400025a400, 0x4000a8a0b0, 0x4000124a20)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	./main.go:196 +0x1a0
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/nhp/plugins.(*PluginHandlerSymbol).AuthWithHttp(0x40000f95c8?, 0x4000576c8d?, 0x10d00000010?, 0xffff54382948?)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/nhp@v0.5.0/plugins/serverpluginhandler.go:132 +0x70
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/endpoints/server.(*HttpServer).authWithAspPlugin(0x4000022be0, 0x400025a400, 0x4000a8a0b0)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/endpoints/server/httpauth.go:24 +0xe8
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/endpoints/server.(*HttpServer).initRouter.func1(0x400025a400)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/endpoints/server/httpserver.go:224 +0x350
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(...)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.CustomRecoveryWithWriter.func1(0x400025a400)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/recovery.go:102 +0x78
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(...)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.LoggerWithConfig.func1(0x400025a400)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/logger.go:249 +0xb4
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(0x400025a400)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185 +0x3c
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/endpoints/server.(*HttpServer).Start.corsMiddleware.func3(0x400025a400)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/endpoints/server/httpserver.go:306 +0x264
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(...)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Engine).handleHTTPRequest(0x4000634340, 0x400025a400)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/gin.go:633 +0x6c4
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Engine).ServeHTTP(0x4000634340, {0x1021218, 0x400024c0e0}, 0x4000332c80)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/gin.go:589 +0x170
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] net/http.serverHandler.ServeHTTP({0x40004eeed0?}, {0x1021218?, 0x400024c0e0?}, 0x6?)
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	net/http/server.go:3301 +0xbc
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] net/http.(*conn).serve(0x40001706c0, {0x10223a0, 0x40004eec30})
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	net/http/server.go:2102 +0x52c
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] created by net/http.(*Server).Serve in goroutine 66
2025/04/21 06:03:43 utils.go:28: NHP-Server [Error] 	net/http/server.go:3454 +0x3d8
2025/04/21 06:03:43 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:03:43 | 200 |     6.53975ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:03:51 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:17383 -> [::]:62206), 160 bytes
2025/04/21 06:03:51 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:17383
2025/04/21 06:03:51 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:17383 -> [::]:62206)
2025/04/21 06:03:56 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] runtime error: invalid memory address or nil pointer dereference
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] goroutine 48 [running]:
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] runtime/debug.Stack()
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	runtime/debug/stack.go:26 +0x64
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/nhp/utils.CatchPanic()
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/nhp@v0.5.0/utils/utils.go:26 +0x50
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] panic({0xe14ba0?, 0x14d1220?})
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	runtime/panic.go:792 +0x124
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).HTML(0x400025a400, 0xc8, {0xffff3f868a4c?, 0x5?}, {0xe60ea0?, 0x40004ef5c0?})
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:971 +0x38
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] plugin/unnamed-fb91a1b7bf02861df8d35b30214716de1d61b84c.authAndShowLogin(0x400025a400, 0x4000a8a160, 0x400062c000, 0xffff9ae5df60?)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	./main.go:214 +0x24c
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] plugin/unnamed-fb91a1b7bf02861df8d35b30214716de1d61b84c.AuthWithHttp(0x400025a400, 0x4000a8a160, 0x4000124be0)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	./main.go:196 +0x1a0
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/nhp/plugins.(*PluginHandlerSymbol).AuthWithHttp(0x40005b95c8?, 0x400057710d?, 0xd00000010?, 0xffff54382948?)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/nhp@v0.5.0/plugins/serverpluginhandler.go:132 +0x70
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/endpoints/server.(*HttpServer).authWithAspPlugin(0x4000022be0, 0x400025a400, 0x4000a8a160)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/endpoints/server/httpauth.go:24 +0xe8
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/endpoints/server.(*HttpServer).initRouter.func1(0x400025a400)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/endpoints/server/httpserver.go:224 +0x350
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(...)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.CustomRecoveryWithWriter.func1(0x400025a400)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/recovery.go:102 +0x78
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(...)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.LoggerWithConfig.func1(0x400025a400)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/logger.go:249 +0xb4
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(0x400025a400)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185 +0x3c
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/OpenNHP/opennhp/endpoints/server.(*HttpServer).Start.corsMiddleware.func3(0x400025a400)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/OpenNHP/opennhp/endpoints/server/httpserver.go:306 +0x264
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Context).Next(...)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/context.go:185
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Engine).handleHTTPRequest(0x4000634340, 0x400025a400)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/gin.go:633 +0x6c4
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] github.com/gin-gonic/gin.(*Engine).ServeHTTP(0x4000634340, {0x1021218, 0x400024c2a0}, 0x4000332dc0)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	github.com/gin-gonic/gin@v1.10.0/gin.go:589 +0x170
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] net/http.serverHandler.ServeHTTP({0x40004ef2f0?}, {0x1021218?, 0x400024c2a0?}, 0x6?)
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	net/http/server.go:3301 +0xbc
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] net/http.(*conn).serve(0x40005fc000, {0x10223a0, 0x40004eec30})
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	net/http/server.go:2102 +0x52c
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] created by net/http.(*Server).Serve in goroutine 66
2025/04/21 06:03:56 utils.go:28: NHP-Server [Error] 	net/http/server.go:3454 +0x3d8
2025/04/21 06:03:56 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:03:56 | 200 |     460.667µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:04:11 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:17383 -> [::]:62206), 160 bytes
2025/04/21 06:04:11 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:17383
2025/04/21 06:04:11 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:17383 -> [::]:62206)
2025/04/21 06:04:50 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 06:04:50 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421035448 started              ===
2025/04/21 06:04:50 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 06:04:50 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:54:48                       ===
2025/04/21 06:04:50 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 06:04:50 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 06:04:50 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 06:04:50 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 06:04:50 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 06:04:50 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 06:04:50 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 06:04:50) started  ===
2025/04/21 06:04:50 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 06:04:50 httpserver.go:180: NHP-Server [Info] gin load file example_acdemo.html from /nhp-server/templates
2025/04/21 06:04:50 httpserver.go:180: NHP-Server [Info] gin load file example_login.html from /nhp-server/templates
2025/04/21 06:04:50 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 06:04:50 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 06:04:50 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 06:04:50 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 06:04:50 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 06:04:50 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 06:04:50 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 06:04:50 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 06:04:50 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 06:04:50 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 06:04:50 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 06:04:50 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 06:04:50 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 06:04:50 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 06:04:50 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 06:04:50 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 06:04:50 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 06:04:50 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 06:04:50 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 06:04:50 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 06:04:50 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 06:04:50 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 06:04:50 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 06:04:50 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 06:04:50 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 06:04:50 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 06:04:50 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 06:04:50 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 06:04:50 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 06:04:50 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 06:04:50 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 06:04:50 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 06:04:50 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 06:04:50 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 06:04:50 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:24051 -> [::]:62206), 293 bytes
2025/04/21 06:04:50 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:24051
2025/04/21 06:04:50 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:24051 to [::]:62206
2025/04/21 06:04:50 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:24051 started
2025/04/21 06:04:50 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:24051
2025/04/21 06:04:50 device.go:335: NHP-Server [Debug] packetToMsgRoutine 5: decrypting [NHP-AOL] raw packet
2025/04/21 06:04:50 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:04:50 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:HDhkduw4ewrDAPFuei3EuPzIJeoM8A3CN3QxxXw3tnSPlh/+6krNCimsq/CtUicDcnHTMpCIbfykKKVSnEDzHw==
2025/04/21 06:04:50 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:rWmIxs9LiNgTPCcSrifnmm0Mhj9DlZ9ywaMtR1mMGes=,NonceBytes:AAAAAAAAAAAAAAAS,StaticBytes:1ppHqILZB830CLdGHEe2FnQ3JYdEmI2bRqb+21wpUNCr+7dG3rjLzEggwkCtnzIIJ1ujzQjao26rnyQLfX4b37lBrH0Cpz1coluGvxmPVTI=
2025/04/21 06:04:50 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 5: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:04:50 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:04:50 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:04:50 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:04:50 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:04:50 transaction.go:229: NHP-Server [Debug] Remote transaction 18 start
2025/04/21 06:04:50 transaction.go:249: NHP-Server [Debug] Remote transaction 18 quit
2025/04/21 06:04:50 device.go:182: NHP-Server [Debug] msgToPacketRoutine 6: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:24051"}
2025/04/21 06:04:50 device.go:233: NHP-Server [Debug] msgToPacketRoutine 6: complete encrypting [NHP-AAK]
2025/04/21 06:04:50 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:04:50 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:04:50 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:24051), 297 bytes
2025/04/21 06:04:53 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:04:53 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:04:53 | 200 |      377.75µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
Error #01: html/template: "example/example_login.html" is undefined
2025/04/21 06:05:05 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 06:05:05 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421035448 started              ===
2025/04/21 06:05:05 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 06:05:05 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:54:48                       ===
2025/04/21 06:05:05 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 06:05:05 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 06:05:05 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 06:05:05 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 06:05:05 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 06:05:05 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 06:05:05 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 06:05:05) started  ===
2025/04/21 06:05:05 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 06:05:05 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 06:05:05 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 06:05:05 httpserver.go:180: NHP-Server [Info] gin load file passcode/example_acdemo.html from /nhp-server/templates
2025/04/21 06:05:05 httpserver.go:180: NHP-Server [Info] gin load file passcode/example_login.html from /nhp-server/templates
2025/04/21 06:05:05 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 06:05:05 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 06:05:05 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 06:05:05 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 06:05:05 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 06:05:05 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 06:05:05 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 06:05:05 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 06:05:05 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 06:05:05 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 06:05:05 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 06:05:05 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 06:05:05 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 06:05:05 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 06:05:05 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 06:05:05 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 06:05:05 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 06:05:05 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 06:05:05 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 06:05:05 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 06:05:05 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 06:05:05 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 06:05:05 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 06:05:05 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 06:05:05 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 06:05:05 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 06:05:05 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 06:05:05 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 06:05:05 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 06:05:05 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 06:05:05 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 06:05:05 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 06:05:05 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 06:05:05 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 06:05:05 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:44142 -> [::]:62206), 293 bytes
2025/04/21 06:05:05 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:44142
2025/04/21 06:05:05 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:44142 to [::]:62206
2025/04/21 06:05:05 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:44142 started
2025/04/21 06:05:05 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:44142
2025/04/21 06:05:05 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 06:05:05 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:05:05 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:OEIIlq0t0bVM9kN8dbr0O4Xqespe281BlRiBpeMXIUIRjiiudIY2bHqVuLTYfDm4Dt47sDPzYtd+Z3ey/ytNfw==
2025/04/21 06:05:05 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:v5TbKfmok4Uvzb7oYjM4cRrR6qy1VwE1e+aZBGTR4kc=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:4jDSHXRca9cFtsqN3XlIlwYpPMXE3MeSRHUIBxWOl90+e7VxKPrbQmeKZO/O0tcfav8f7qRFXDoM4iEZdv2Ia1hRolX0kqyaBF7KrNGzxZo=
2025/04/21 06:05:05 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:05:05 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:05:05 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:05:05 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:05:05 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:05:05 transaction.go:229: NHP-Server [Debug] Remote transaction 1 start
2025/04/21 06:05:05 transaction.go:249: NHP-Server [Debug] Remote transaction 1 quit
2025/04/21 06:05:05 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:44142"}
2025/04/21 06:05:05 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AAK]
2025/04/21 06:05:05 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:05:05 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:05:05 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:44142), 297 bytes
2025/04/21 06:05:05 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:05:05 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:05:05 | 200 |     18.6935ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:05:08 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 06:05:08 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"220.191.216.236","port":443}],"opnTime":20}
2025/04/21 06:05:08 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 06:05:08 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AOP]
2025/04/21 06:05:08 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 06:05:08 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:05:08 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 06:05:08 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:44142), 464 bytes
2025/04/21 06:05:08 transaction.go:138: NHP-Server [Debug] Local transaction 1 start
2025/04/21 06:05:08 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:44142 -> [::]:62206), 349 bytes
2025/04/21 06:05:08 udpserver.go:465: NHP-Server [Debug] Received udp packet len [349] from addr: 192.168.65.1:44142
2025/04/21 06:05:08 transaction.go:173: NHP-Server [Debug] Local transaction 1 quit
2025/04/21 06:05:08 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-ART] raw packet
2025/04/21 06:05:08 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:OSrXf7OwFctI1Nhvvp46C+GXy7hS89vdJszCc64XMWuUl7rW+UvpY6o+MGiKaCPfBoNNyyYGJ16/crMJH6PVOA==
2025/04/21 06:05:08 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:goMlNv6uyWXTUwGWKjkkDEgR6jBt4bX9+P5bMp8wFps=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:P6Vlm3INoDPfrBPNKXE0VZ0TsbrHvlRyAwE6RMftE6YjevSD5PNiTjkyulFJqScA168BD6PCkMkC3sZFnydpEvi32PMAhAcZgI18UwBX+34=
2025/04/21 06:05:08 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-ART] message: {"errCode":"0","opnTime":20,"token":"bugsy60Tz7XekgfGgWNdE6xubLvw6rIgEYPlueMbCr8=","preAct":null}
2025/04/21 06:05:08 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 06:05:08 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 06:05:08 httpserver.go:402: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] succeed
2025/04/21 06:05:08 main.go:242: Plugin[example] [Info] knock succeeded.
2025/04/21 06:05:08 main.go:276: Plugin[example] [Info] ctx.SetCookie.
2025/04/21 06:05:08 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:05:08 | 200 |   23.142042ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 06:05:30 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:44142 -> [::]:62206), 160 bytes
2025/04/21 06:05:30 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:44142
2025/04/21 06:05:30 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:44142 -> [::]:62206)
2025/04/21 06:05:50 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:44142 -> [::]:62206), 160 bytes
2025/04/21 06:05:50 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:44142
2025/04/21 06:05:50 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:44142 -> [::]:62206)
2025/04/21 06:06:10 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:44142 -> [::]:62206), 293 bytes
2025/04/21 06:06:10 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:44142
2025/04/21 06:06:10 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-AOL] raw packet
2025/04/21 06:06:10 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:06:10 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:g1qe0tsvBtZPVt/tMHOW2Ta1sZ8fZVHZDe6/RV71Y47/XENMCGc6QMKSYjDtvAY6z+9M779gpSb98aZNeIXBbg==
2025/04/21 06:06:10 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:qQuDnCKCdUEljnvpUyNc4/ruLSEtrCLxGcNiWeHWQIk=,NonceBytes:AAAAAAAAAAAAAAAE,StaticBytes:fqPz/TknXo0A1X7tAxEjaZwftGGVi5IhUNcCDQqIRuQY22hrf4Z1+ezwddSqAfVYy9hjXhxy8Ezh8nJqCA0kZq7BxUCT7fvSG9WgpB3+/IM=
2025/04/21 06:06:10 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:06:10 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:06:10 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:06:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:06:10 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:06:10 transaction.go:229: NHP-Server [Debug] Remote transaction 4 start
2025/04/21 06:06:10 transaction.go:249: NHP-Server [Debug] Remote transaction 4 quit
2025/04/21 06:06:10 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:44142"}
2025/04/21 06:06:10 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AAK]
2025/04/21 06:06:10 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:06:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:06:10 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:44142), 297 bytes
2025/04/21 06:06:30 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:44142 -> [::]:62206), 160 bytes
2025/04/21 06:06:30 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:44142
2025/04/21 06:06:30 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:44142 -> [::]:62206)
2025/04/21 06:06:50 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:44142 -> [::]:62206), 160 bytes
2025/04/21 06:06:50 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:44142
2025/04/21 06:06:50 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:44142 -> [::]:62206)
2025/04/21 06:07:10 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:44142 -> [::]:62206), 293 bytes
2025/04/21 06:07:10 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:44142
2025/04/21 06:07:10 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 06:07:10 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:07:10 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:XTDb5r2yqsb2A1q2S+Lbn61iErr6GzYUKOCgx17THc9EN0xDVep0Wx34v8Ew7VG8iTsPwN8hWSpBTx5pYA44dg==
2025/04/21 06:07:10 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:L/O2czPAbPmhc5na2MDwWC6GTCX6I7vdp3IWQdPv4xU=,NonceBytes:AAAAAAAAAAAAAAAH,StaticBytes:A+T4SrDXcxkwbMe/zUPtl9PTmsl06gDUmr7sgNHHBCrvJn5L/6Eelj5ketD1kk7JkmY9G2mgq0k5mjqr8qamoLPIAl+bCDKzwbGCkXEpotI=
2025/04/21 06:07:10 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:07:10 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:07:10 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:07:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:07:10 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:07:10 transaction.go:229: NHP-Server [Debug] Remote transaction 7 start
2025/04/21 06:07:10 transaction.go:249: NHP-Server [Debug] Remote transaction 7 quit
2025/04/21 06:07:10 device.go:182: NHP-Server [Debug] msgToPacketRoutine 3: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:44142"}
2025/04/21 06:07:10 device.go:233: NHP-Server [Debug] msgToPacketRoutine 3: complete encrypting [NHP-AAK]
2025/04/21 06:07:10 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:07:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:07:10 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:44142), 297 bytes
2025/04/21 06:07:30 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:44142 -> [::]:62206), 160 bytes
2025/04/21 06:07:30 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:44142
2025/04/21 06:07:30 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:44142 -> [::]:62206)
2025/04/21 06:07:50 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:44142 -> [::]:62206), 160 bytes
2025/04/21 06:07:50 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:44142
2025/04/21 06:07:50 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:44142 -> [::]:62206)
2025/04/21 06:08:10 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:44142 -> [::]:62206), 293 bytes
2025/04/21 06:08:10 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:44142
2025/04/21 06:08:10 device.go:335: NHP-Server [Debug] packetToMsgRoutine 4: decrypting [NHP-AOL] raw packet
2025/04/21 06:08:10 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:08:10 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:SGGYt2S9yVJRtvS1pfve4LIsSo/UJP04hFKm6hwf5R/7G17zBCN6hNxLTFMu5Llb8VOMYfdiMjhnakljoyF6lg==
2025/04/21 06:08:10 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:FE+lvxcMXorYCO6xEAxqV3Y8KXoemsic4kV3KQt3XxI=,NonceBytes:AAAAAAAAAAAAAAAK,StaticBytes:/fD4z7Jlq8DM+A0/qSVRMb6vvNVQdWPEmRvC9g70FluWkBwxO25ITHoyLOgp77xpu/szsWuhK8dzwtn9Z3RmIhhiCOTpuxnnuf64IpIIE3k=
2025/04/21 06:08:10 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 4: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:08:10 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:08:10 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:08:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:08:10 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:08:10 transaction.go:229: NHP-Server [Debug] Remote transaction 10 start
2025/04/21 06:08:10 transaction.go:249: NHP-Server [Debug] Remote transaction 10 quit
2025/04/21 06:08:10 device.go:182: NHP-Server [Debug] msgToPacketRoutine 4: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:44142"}
2025/04/21 06:08:10 device.go:233: NHP-Server [Debug] msgToPacketRoutine 4: complete encrypting [NHP-AAK]
2025/04/21 06:08:10 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:08:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:08:10 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:44142), 297 bytes
2025/04/21 06:08:30 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:44142 -> [::]:62206), 160 bytes
2025/04/21 06:08:30 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:44142
2025/04/21 06:08:30 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:44142 -> [::]:62206)
2025/04/21 06:08:50 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:44142 -> [::]:62206), 160 bytes
2025/04/21 06:08:50 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:44142
2025/04/21 06:08:50 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:44142 -> [::]:62206)
2025/04/21 06:08:59 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:08:59 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:08:59 | 200 |    1.084041ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:09:09 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 06:09:09 device.go:182: NHP-Server [Debug] msgToPacketRoutine 5: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"220.191.216.236","port":443}],"opnTime":20}
2025/04/21 06:09:09 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 06:09:09 device.go:233: NHP-Server [Debug] msgToPacketRoutine 5: complete encrypting [NHP-AOP]
2025/04/21 06:09:09 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 06:09:09 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:09:09 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 06:09:09 transaction.go:138: NHP-Server [Debug] Local transaction 2 start
2025/04/21 06:09:09 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:44142), 464 bytes
2025/04/21 06:09:09 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:44142 -> [::]:62206), 349 bytes
2025/04/21 06:09:09 udpserver.go:465: NHP-Server [Debug] Received udp packet len [349] from addr: 192.168.65.1:44142
2025/04/21 06:09:09 transaction.go:173: NHP-Server [Debug] Local transaction 2 quit
2025/04/21 06:09:09 device.go:335: NHP-Server [Debug] packetToMsgRoutine 5: decrypting [NHP-ART] raw packet
2025/04/21 06:09:09 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:ETISL+LMDnrJz4h6UXCPcuTXYpNeLbBu2LLOghAEEDUfX5Jd642RQ8sAd1JZ0M738zEB09JImSKrYKoKG/k61A==
2025/04/21 06:09:09 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:BIloHq5hMq1yeOuj+tuITbZV3IHXe0Q/+NV6gxOUWqM=,NonceBytes:AAAAAAAAAAAAAAAC,StaticBytes:+wSSEYQaMCBf/F2K2xxzOAqgJCPB+SjWyako5zogRsYsl9fYkN4bsb3RLCYzdmkW1aNCf7LncQIspcyAW02B6bNsd9LSxk/pke7Q9tWAvCM=
2025/04/21 06:09:09 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 5: complete decrypting [NHP-ART] message: {"errCode":"0","opnTime":20,"token":"gNvCePTbpIo8e0WFxJqMHO417Tqe+Fl0/X0CNKqO0m4=","preAct":null}
2025/04/21 06:09:09 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 06:09:09 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 06:09:09 httpserver.go:402: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] succeed
2025/04/21 06:09:09 main.go:242: Plugin[example] [Info] knock succeeded.
2025/04/21 06:09:09 main.go:276: Plugin[example] [Info] ctx.SetCookie.
2025/04/21 06:09:09 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:09:09 | 200 |   24.903459ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 06:09:30 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:44142 -> [::]:62206), 160 bytes
2025/04/21 06:09:30 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:44142
2025/04/21 06:09:30 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:44142 -> [::]:62206)
2025/04/21 06:09:50 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:44142 -> [::]:62206), 160 bytes
2025/04/21 06:09:50 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:44142
2025/04/21 06:09:50 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:44142 -> [::]:62206)
2025/04/21 06:10:10 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:44142 -> [::]:62206), 293 bytes
2025/04/21 06:10:10 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:44142
2025/04/21 06:10:10 device.go:335: NHP-Server [Debug] packetToMsgRoutine 6: decrypting [NHP-AOL] raw packet
2025/04/21 06:10:10 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:10:10 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:cO0G2pZqxg1HY6ZwoJIFjarjHc+z/waBo+inPXp7LbXumzA7WQgJ68xAML1+RrWy43xe2yiWV9Dsq/PIx9j1YQ==
2025/04/21 06:10:10 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:l1zYgnDXoHcR9j4YT1qtk3K+eBD6jGiksohhnAnC2IY=,NonceBytes:AAAAAAAAAAAAAAAP,StaticBytes:IljEHdzoBB3Nvbi/nwIPPPnBTehyhI28Qyds8nsmGqKthXSHbjf+KENoNMlsESJyQVyIexhpotWH9+yL3tYR9n38VeHFkN2CEyODtvA423s=
2025/04/21 06:10:10 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 6: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:10:10 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:10:10 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:10:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:10:10 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:10:10 transaction.go:229: NHP-Server [Debug] Remote transaction 15 start
2025/04/21 06:10:10 transaction.go:249: NHP-Server [Debug] Remote transaction 15 quit
2025/04/21 06:10:10 device.go:182: NHP-Server [Debug] msgToPacketRoutine 6: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:44142"}
2025/04/21 06:10:10 device.go:233: NHP-Server [Debug] msgToPacketRoutine 6: complete encrypting [NHP-AAK]
2025/04/21 06:10:10 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:10:10 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:10:10 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:44142), 297 bytes
2025/04/21 06:10:38 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 06:10:38 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421035448 started              ===
2025/04/21 06:10:38 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 06:10:38 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:54:48                       ===
2025/04/21 06:10:38 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 06:10:38 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 06:10:38 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 06:10:38 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 06:10:38 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 06:10:38 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 06:10:38 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 06:10:38) started  ===
2025/04/21 06:10:38 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 06:10:38 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 06:10:38 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 06:10:38 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 06:10:38 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 06:10:38 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 06:10:38 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 06:10:38 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 06:10:38 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 06:10:38 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 06:10:38 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 06:10:38 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 06:10:38 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 06:10:38 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 06:10:38 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 06:10:38 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 06:10:38 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 06:10:38 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 06:10:38 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 06:10:38 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 06:10:38 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 06:10:38 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 06:10:38 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 06:10:38 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 06:10:38 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 06:10:38 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 06:10:38 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 06:10:38 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 06:10:38 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 06:10:38 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 06:10:38 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 06:10:38 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 06:10:38 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 06:10:38 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 06:10:38 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 06:10:38 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 06:10:38 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 06:10:38 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:41979 -> [::]:62206), 293 bytes
2025/04/21 06:10:38 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:41979
2025/04/21 06:10:38 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:41979 to [::]:62206
2025/04/21 06:10:38 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:41979 started
2025/04/21 06:10:38 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:41979
2025/04/21 06:10:38 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 06:10:38 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:10:38 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:w2Sn2Ups9KYqUQ/+ri5UyU2x4CXZOrr0c9SqIOLsPI1vsisHqImwBYGmuo/WKhXyoVACLsnv3U5iD4DHqojmhw==
2025/04/21 06:10:38 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:nNwuo0M/+Y/OmBfei2aafz2uogr00HsoVchpADEMkeE=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:TQ0lQQVabsiJxmyqerU9eeJaUnkNCImrbZ4Tjx0OdhNGI36yVx4xTw7nWPFOvW/MD1tqGAPBuYBJTwd+f6YXePcbbGGJm3mnJdPdD0fEDV8=
2025/04/21 06:10:38 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:10:38 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:10:38 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:10:38 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:10:38 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:10:38 transaction.go:229: NHP-Server [Debug] Remote transaction 1 start
2025/04/21 06:10:38 transaction.go:249: NHP-Server [Debug] Remote transaction 1 quit
2025/04/21 06:10:38 device.go:182: NHP-Server [Debug] msgToPacketRoutine 4: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:41979"}
2025/04/21 06:10:38 device.go:233: NHP-Server [Debug] msgToPacketRoutine 4: complete encrypting [NHP-AAK]
2025/04/21 06:10:38 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:10:38 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:10:38 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:41979), 297 bytes
2025/04/21 06:10:47 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:10:47 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:10:47 | 200 |    1.582292ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:10:49 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:10:49 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:10:49 | 200 |     331.375µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:10:49 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:10:49 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:10:49 | 200 |     197.792µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:10:58 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:41979 -> [::]:62206), 160 bytes
2025/04/21 06:10:58 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:41979
2025/04/21 06:10:58 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:41979 -> [::]:62206)
2025/04/21 06:11:18 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:41979 -> [::]:62206), 160 bytes
2025/04/21 06:11:18 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:41979
2025/04/21 06:11:18 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:41979 -> [::]:62206)
2025/04/21 06:11:38 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:41979 -> [::]:62206), 293 bytes
2025/04/21 06:11:38 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:41979
2025/04/21 06:11:38 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-AOL] raw packet
2025/04/21 06:11:38 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:11:38 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:dGoxTxhZsi01zviL735dMOqS0YS2HD0GeQjjiSYQB2GR4ZthbvEKZxYgis8RfymWb1fOpgeDjTl6fHYRJywzsQ==
2025/04/21 06:11:38 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:AuZxv85++FAnzTFE9Zrgc+lPiGj+fQZxtBJIQ/HpLRM=,NonceBytes:AAAAAAAAAAAAAAAE,StaticBytes:ckWTDosgaVP77XrMY5HKqDKle9TrhsK6Xt3pnF86GM+yLJEL1pYmYiunm9AI9BHRydBbpiZLC/Tl3u42M1lsLdY4aRyxvg10t6N2Uiq9wDs=
2025/04/21 06:11:38 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:11:38 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:11:38 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:11:38 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:11:38 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:11:38 transaction.go:229: NHP-Server [Debug] Remote transaction 4 start
2025/04/21 06:11:38 transaction.go:249: NHP-Server [Debug] Remote transaction 4 quit
2025/04/21 06:11:38 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:41979"}
2025/04/21 06:11:38 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AAK]
2025/04/21 06:11:38 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:11:38 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:11:38 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:41979), 297 bytes
2025/04/21 06:12:00 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:12:00 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:12:00 | 200 |    1.420708ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:12:01 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 06:12:01 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421035448 started              ===
2025/04/21 06:12:01 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 06:12:01 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:54:48                       ===
2025/04/21 06:12:01 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 06:12:01 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 06:12:01 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 06:12:01 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 06:12:01 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 06:12:01 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 06:12:01 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 06:12:01) started  ===
2025/04/21 06:12:01 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 06:12:01 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 06:12:01 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 06:12:01 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 06:12:01 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 06:12:01 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 06:12:01 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 06:12:01 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 06:12:01 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 06:12:01 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 06:12:01 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 06:12:01 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 06:12:01 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 06:12:01 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 06:12:01 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 06:12:01 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 06:12:01 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 06:12:01 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 06:12:01 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 06:12:01 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 06:12:01 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 06:12:01 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 06:12:01 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 06:12:01 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 06:12:01 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 06:12:01 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 06:12:01 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 06:12:01 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 06:12:01 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 06:12:01 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 06:12:01 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 06:12:01 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 06:12:01 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 06:12:01 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 06:12:01 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 06:12:01 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 06:12:01 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 06:12:01 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:47929 -> [::]:62206), 293 bytes
2025/04/21 06:12:01 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:47929
2025/04/21 06:12:01 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:47929 to [::]:62206
2025/04/21 06:12:01 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:47929 started
2025/04/21 06:12:01 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:47929
2025/04/21 06:12:01 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 06:12:01 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:12:01 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:99GWTUG37S+vupXQYYFgDkhxheMoWXSneC+Z/9Rkuxdvc14JfYHQ0caardT2oyNtXg4L7F6Ds0E+SkKQQhJHYA==
2025/04/21 06:12:01 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:SsVTu8JK9XO1ShYQvcQxK/kWMkcumcSJqX5uCgkkMmk=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:WCMHLuuB2W7Lv44nsshAsqwymuSfG3Huf+qVjyz03YJPY0YqGssdwCoF6eV5uZMvI5sPbNYnZlQMk3jdTPnlEfUlNOLJy9eGs0fTW7YD9zs=
2025/04/21 06:12:01 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:12:01 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:12:01 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:12:01 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:12:01 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:12:01 transaction.go:229: NHP-Server [Debug] Remote transaction 1 start
2025/04/21 06:12:01 transaction.go:249: NHP-Server [Debug] Remote transaction 1 quit
2025/04/21 06:12:01 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:47929"}
2025/04/21 06:12:01 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AAK]
2025/04/21 06:12:01 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:12:01 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:12:01 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:47929), 297 bytes
2025/04/21 06:12:02 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 06:12:02 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"172.19.0.3","port":80}],"opnTime":20}
2025/04/21 06:12:02 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 06:12:02 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AOP]
2025/04/21 06:12:02 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 06:12:02 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:12:02 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 06:12:02 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:47929), 461 bytes
2025/04/21 06:12:02 transaction.go:138: NHP-Server [Debug] Local transaction 1 start
2025/04/21 06:12:02 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:47929 -> [::]:62206), 349 bytes
2025/04/21 06:12:02 udpserver.go:465: NHP-Server [Debug] Received udp packet len [349] from addr: 192.168.65.1:47929
2025/04/21 06:12:02 transaction.go:173: NHP-Server [Debug] Local transaction 1 quit
2025/04/21 06:12:02 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-ART] raw packet
2025/04/21 06:12:02 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:GxPv7qhM1Ex5bln+EJhTwb5R1dG8nBFpJLLGyvJ3NWCB4VHztQrAnm4vLIQRYPrIPK3hpfxOsWyQwWAecXl+gw==
2025/04/21 06:12:02 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:5b36CoX1sTgIETDC7oMjXD4id0mAJcLfHQ1jeVs0JmM=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:6cK1KsFCxr3DUw7q2O6zKZ0Q5CIzU1cjn7puhv7c9AE7XHEfBqUOA9HQc2puY5WZYIzHYZl6qb1YZwS8mrkCrHS3z/SFpBwEcntDqF6oxK4=
2025/04/21 06:12:02 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-ART] message: {"errCode":"0","opnTime":20,"token":"k6uTVBIA9j+XN+ZOIMZcJIR/z2x+dLsePv4YfYWLVmQ=","preAct":null}
2025/04/21 06:12:02 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 06:12:02 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 06:12:02 httpserver.go:402: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] succeed
2025/04/21 06:12:02 main.go:242: Plugin[example] [Info] knock succeeded.
2025/04/21 06:12:02 main.go:276: Plugin[example] [Info] ctx.SetCookie.
2025/04/21 06:12:02 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:12:02 | 200 |   27.605167ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 06:12:26 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:47929 -> [::]:62206), 160 bytes
2025/04/21 06:12:26 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:47929
2025/04/21 06:12:26 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:47929 -> [::]:62206)
2025/04/21 06:12:38 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:12:38 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:12:38 | 200 |    2.391584ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:12:40 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 06:12:40 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"172.19.0.3","port":80}],"opnTime":20}
2025/04/21 06:12:40 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 06:12:40 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AOP]
2025/04/21 06:12:40 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 06:12:40 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:12:40 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 06:12:40 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:47929), 461 bytes
2025/04/21 06:12:40 transaction.go:138: NHP-Server [Debug] Local transaction 2 start
2025/04/21 06:12:40 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:47929 -> [::]:62206), 349 bytes
2025/04/21 06:12:40 udpserver.go:465: NHP-Server [Debug] Received udp packet len [349] from addr: 192.168.65.1:47929
2025/04/21 06:12:40 transaction.go:173: NHP-Server [Debug] Local transaction 2 quit
2025/04/21 06:12:40 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-ART] raw packet
2025/04/21 06:12:40 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:G9gK92fbvdSZWI+iXSOvxy1FSizJ580bSVqFIJkuzihyuV1Lc/jvRb/DEtOYKDp9MeOl2wArbIg92pIYss7AFA==
2025/04/21 06:12:40 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:Fo74It6rD0MG4wi3arHabMdiqAnNhp6V+Zl4JtV1bhQ=,NonceBytes:AAAAAAAAAAAAAAAC,StaticBytes:xKTtkhWnLeNuSQIQav8xCX8XEKwuq6IrTrDyzJdIfg4ine33680SOuKSAzced5lgQhou5ybzlZIZv2cmuzKnwkDdTIx1OgAMxB6ayE3ijts=
2025/04/21 06:12:40 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-ART] message: {"errCode":"0","opnTime":20,"token":"hrlfrU64oX99SJHMa59b5XJAMtCmyfs/1ZVGKll8isg=","preAct":null}
2025/04/21 06:12:40 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 06:12:40 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 06:12:40 httpserver.go:402: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] succeed
2025/04/21 06:12:40 main.go:242: Plugin[example] [Info] knock succeeded.
2025/04/21 06:12:40 main.go:276: Plugin[example] [Info] ctx.SetCookie.
2025/04/21 06:12:40 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:12:40 | 200 |   15.562834ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 06:13:01 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:47929 -> [::]:62206), 160 bytes
2025/04/21 06:13:01 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:47929
2025/04/21 06:13:01 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:47929 -> [::]:62206)
2025/04/21 06:13:21 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:47929 -> [::]:62206), 160 bytes
2025/04/21 06:13:21 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:47929
2025/04/21 06:13:21 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:47929 -> [::]:62206)
2025/04/21 06:13:41 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:47929 -> [::]:62206), 293 bytes
2025/04/21 06:13:41 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:47929
2025/04/21 06:13:41 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 06:13:41 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:13:41 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:FjNqMgLMalbM6hgLvmgkfoozUEn63BSPRaNf3wIhwVjSxT1Pufy0KKcuXrxIc6RtIi/YIq3f9L9aLHA9bYRASQ==
2025/04/21 06:13:41 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:urw6NeLLheNhmPTgSp1yTzodDvy7k96mtky4HKwdr84=,NonceBytes:AAAAAAAAAAAAAAAF,StaticBytes:SfX8QL1E6RDQLQrk/osn2Z/btv49RcR3D58afYJisweBaPNgdm1K3X3GJKV5Dni4NVp8/WrlClFrN2LcxexwaZ+Wh0x+T9780Zpg/SwYvJ4=
2025/04/21 06:13:41 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:13:41 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:13:41 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:13:41 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:13:41 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:13:41 transaction.go:229: NHP-Server [Debug] Remote transaction 5 start
2025/04/21 06:13:41 transaction.go:249: NHP-Server [Debug] Remote transaction 5 quit
2025/04/21 06:13:41 device.go:182: NHP-Server [Debug] msgToPacketRoutine 3: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:47929"}
2025/04/21 06:13:41 device.go:233: NHP-Server [Debug] msgToPacketRoutine 3: complete encrypting [NHP-AAK]
2025/04/21 06:13:41 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:13:41 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:13:41 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:47929), 297 bytes
2025/04/21 06:14:01 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:47929 -> [::]:62206), 160 bytes
2025/04/21 06:14:01 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:47929
2025/04/21 06:14:01 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:47929 -> [::]:62206)
2025/04/21 06:15:02 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 06:15:02 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421035448 started              ===
2025/04/21 06:15:02 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 06:15:02 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:54:48                       ===
2025/04/21 06:15:02 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 06:15:02 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 06:15:02 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 06:15:02 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 06:15:02 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 06:15:02 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 06:15:02 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 06:15:02) started  ===
2025/04/21 06:15:02 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 06:15:02 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 06:15:02 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 06:15:02 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 06:15:02 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 06:15:02 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 06:15:02 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 06:15:02 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 06:15:02 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 06:15:02 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 06:15:02 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 06:15:02 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 06:15:02 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 06:15:02 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 06:15:02 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 06:15:02 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 06:15:02 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 06:15:02 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 06:15:02 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 06:15:02 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 06:15:02 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 06:15:02 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 06:15:02 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 06:15:02 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 06:15:02 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 06:15:02 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 06:15:02 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 06:15:02 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 06:15:02 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 06:15:02 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 06:15:02 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 06:15:02 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 06:15:02 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 06:15:02 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 06:15:02 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 06:15:02 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 06:15:02 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 06:15:02 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:52767 -> [::]:62206), 293 bytes
2025/04/21 06:15:02 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:52767
2025/04/21 06:15:02 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:52767 to [::]:62206
2025/04/21 06:15:02 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:52767 started
2025/04/21 06:15:02 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:52767
2025/04/21 06:15:02 device.go:335: NHP-Server [Debug] packetToMsgRoutine 4: decrypting [NHP-AOL] raw packet
2025/04/21 06:15:02 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:15:02 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:fXsBlXa9lEsg52jhiFmM+tq515T3ow6wMftvHURZChxdJo1xRWp8XjEgWmUjILhv4GTw7EqJosVJ3vkoY6wu2A==
2025/04/21 06:15:02 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:i5dKTpNx34ojtxeFBWBT6Qrn3L8+a9mXGwvc8vppUpk=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:0hoq52l7rekEpcANNnXtrPXq6STdFnop8IVEPiIjU8CJ0pmG+YzwR2yqxg/v8L8TqOaApF1TPH5YRcnQOJvWmvKraxMJEur0m9r4TkKcj7w=
2025/04/21 06:15:02 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 4: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:15:02 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:15:02 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:15:02 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:15:02 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:15:02 transaction.go:229: NHP-Server [Debug] Remote transaction 1 start
2025/04/21 06:15:02 transaction.go:249: NHP-Server [Debug] Remote transaction 1 quit
2025/04/21 06:15:02 device.go:182: NHP-Server [Debug] msgToPacketRoutine 9: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:52767"}
2025/04/21 06:15:02 device.go:233: NHP-Server [Debug] msgToPacketRoutine 9: complete encrypting [NHP-AAK]
2025/04/21 06:15:02 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:15:02 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:15:02 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:52767), 297 bytes
2025/04/21 06:15:22 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:52767 -> [::]:62206), 160 bytes
2025/04/21 06:15:22 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:52767
2025/04/21 06:15:22 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:52767 -> [::]:62206)
2025/04/21 06:15:37 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:15:37 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:15:37 | 200 |      1.6735ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:15:39 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 06:15:39 device.go:182: NHP-Server [Debug] msgToPacketRoutine 1: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"nhp-ac","port":80}],"opnTime":20}
2025/04/21 06:15:39 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 06:15:39 device.go:233: NHP-Server [Debug] msgToPacketRoutine 1: complete encrypting [NHP-AOP]
2025/04/21 06:15:39 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 06:15:39 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:15:39 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 06:15:39 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:52767), 459 bytes
2025/04/21 06:15:39 transaction.go:138: NHP-Server [Debug] Local transaction 1 start
2025/04/21 06:15:39 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:52767 -> [::]:62206), 378 bytes
2025/04/21 06:15:39 udpserver.go:465: NHP-Server [Debug] Received udp packet len [378] from addr: 192.168.65.1:52767
2025/04/21 06:15:39 transaction.go:173: NHP-Server [Debug] Local transaction 1 quit
2025/04/21 06:15:39 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-ART] raw packet
2025/04/21 06:15:39 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:/y1kcPy9s8wuDELmI/955ePKh1ASbQw2+0rywmKS6mRQMdrA+ovsEB1k9/AWYfzUqsAYBnVxNmKgheZGAfsycg==
2025/04/21 06:15:39 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:0Nn6n/2NVGfvhx8I9ch99YzdhU1AgRSJWKrUGw4eNQA=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:kQdnkbsDIbnry+5/t26MB4DxtUnjf3oo65nNFIug/OI0kOtILQ7bxaUOOY6FxuSAPStENn16b4uBzmEluMM9SXy6gPdKFWFtAttLLNHXaOA=
2025/04/21 06:15:39 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-ART] message: {"errCode":"53004","errMsg":"ipset operation failed","opnTime":0,"token":"ET55EKPR+irIkUjUYa3ijlTHOcUhNaJ6Y6DXWYNBPME=","preAct":null}
2025/04/21 06:15:39 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 06:15:39 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 06:15:39 udpserver.go:859: NHP-Server [Error] server-agent(@192.168.65.1)-ac(testAC-1#1@192.168.65.1:52767)[processACOperation] response error: &{ErrCode:53004 ErrMsg:ipset operation failed OpenTime:0 ACToken:ET55EKPR+irIkUjUYa3ijlTHOcUhNaJ6Y6DXWYNBPME= PreAccessAction:<nil>}
2025/04/21 06:15:39 httpserver.go:395: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] failed: map[demoServer:0x4000394280]
2025/04/21 06:15:39 main.go:237: Plugin[example] [Error] knock failed. ackMsg is nil
2025/04/21 06:15:39 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:15:39 | 200 |   20.215084ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 06:15:43 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:15:43 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:15:43 | 200 |     373.542µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:15:44 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 06:15:44 device.go:182: NHP-Server [Debug] msgToPacketRoutine 2: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"nhp-ac","port":80}],"opnTime":20}
2025/04/21 06:15:44 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 06:15:44 device.go:233: NHP-Server [Debug] msgToPacketRoutine 2: complete encrypting [NHP-AOP]
2025/04/21 06:15:44 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 06:15:44 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:15:44 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 06:15:44 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:52767), 459 bytes
2025/04/21 06:15:44 transaction.go:138: NHP-Server [Debug] Local transaction 2 start
2025/04/21 06:15:44 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:52767 -> [::]:62206), 378 bytes
2025/04/21 06:15:44 udpserver.go:465: NHP-Server [Debug] Received udp packet len [378] from addr: 192.168.65.1:52767
2025/04/21 06:15:44 transaction.go:173: NHP-Server [Debug] Local transaction 2 quit
2025/04/21 06:15:44 device.go:335: NHP-Server [Debug] packetToMsgRoutine 1: decrypting [NHP-ART] raw packet
2025/04/21 06:15:44 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:iIH8gE4KTJq6q463BTk71fOBRPLN0Pjmjl+YMD8B4gc9DnRQLl2CyohVJ/rqvYlw2aoG4yZGL2y5wJDr/eAF1A==
2025/04/21 06:15:44 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:rmWGzU8ix3VnJX5p1JP2+D2co7Z+M+0S/ThQ9ZfxPuc=,NonceBytes:AAAAAAAAAAAAAAAC,StaticBytes:Fx2LMIQG28b/stESCfT3hsTEKgjppbobvcNSpVBS3ps8xhMv1ItQ5xuK76AS8ZLSstJqtHe5NmQypFP3aknRE69Ym1Mjx+ZEEsjcxTZ9uNc=
2025/04/21 06:15:44 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 1: complete decrypting [NHP-ART] message: {"errCode":"53004","errMsg":"ipset operation failed","opnTime":0,"token":"SGfU4gYzu8jHJfTlmK9s+1zMGCXowhwXTKXHVo7rgNU=","preAct":null}
2025/04/21 06:15:44 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 06:15:44 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 06:15:44 udpserver.go:859: NHP-Server [Error] server-agent(@192.168.65.1)-ac(testAC-1#2@192.168.65.1:52767)[processACOperation] response error: &{ErrCode:53004 ErrMsg:ipset operation failed OpenTime:0 ACToken:SGfU4gYzu8jHJfTlmK9s+1zMGCXowhwXTKXHVo7rgNU= PreAccessAction:<nil>}
2025/04/21 06:15:44 httpserver.go:395: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] failed: map[demoServer:0x400014a180]
2025/04/21 06:15:44 main.go:237: Plugin[example] [Error] knock failed. ackMsg is nil
2025/04/21 06:15:44 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:15:44 | 200 |    9.744459ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 06:16:07 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:52767 -> [::]:62206), 160 bytes
2025/04/21 06:16:07 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:52767
2025/04/21 06:16:07 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:52767 -> [::]:62206)
2025/04/21 06:16:13 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:16:13 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:16:13 | 200 |     393.334µs |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:16:15 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 06:16:15 device.go:182: NHP-Server [Debug] msgToPacketRoutine 3: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"nhp-ac","port":80}],"opnTime":20}
2025/04/21 06:16:15 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 06:16:15 device.go:233: NHP-Server [Debug] msgToPacketRoutine 3: complete encrypting [NHP-AOP]
2025/04/21 06:16:15 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 06:16:15 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:16:15 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 06:16:15 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:52767), 459 bytes
2025/04/21 06:16:15 transaction.go:138: NHP-Server [Debug] Local transaction 3 start
2025/04/21 06:16:15 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:52767 -> [::]:62206), 375 bytes
2025/04/21 06:16:15 udpserver.go:465: NHP-Server [Debug] Received udp packet len [375] from addr: 192.168.65.1:52767
2025/04/21 06:16:15 transaction.go:173: NHP-Server [Debug] Local transaction 3 quit
2025/04/21 06:16:15 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-ART] raw packet
2025/04/21 06:16:15 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:m9TZKbf3FwWVzKfmbe928N054SKeTvVwTmWm8SaeXXZEw7Irii30HOY6rRigZqt7iOfXYsVNFaaveShLH4JRsg==
2025/04/21 06:16:15 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:afNpeEOtB2rSB/KT0l/qKRYieYAn/pay2dsUt+dqsF4=,NonceBytes:AAAAAAAAAAAAAAAD,StaticBytes:Jll1jur8Bh5zn+IO1+Nl4U5MYt5yp0WHjNyJe63Z9X89U2xt4G+eJOiuHkpzOnTeF68S8SXQ4g881/JNBEuTb4t29NIgkDsKEfU34HmArvI=
2025/04/21 06:16:15 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-ART] message: {"errCode":"53004","errMsg":"ipset operation failed","opnTime":0,"token":"PTuuqgUTCXppnCwrW7t20yPCwaz+otecOzooKcmmLBw=","preAct":null}
2025/04/21 06:16:15 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 06:16:15 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 06:16:15 udpserver.go:859: NHP-Server [Error] server-agent(@192.168.65.1)-ac(testAC-1#3@192.168.65.1:52767)[processACOperation] response error: &{ErrCode:53004 ErrMsg:ipset operation failed OpenTime:0 ACToken:PTuuqgUTCXppnCwrW7t20yPCwaz+otecOzooKcmmLBw= PreAccessAction:<nil>}
2025/04/21 06:16:15 httpserver.go:395: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] failed: map[demoServer:0x400014a4c0]
2025/04/21 06:16:15 main.go:237: Plugin[example] [Error] knock failed. ackMsg is nil
2025/04/21 06:16:15 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:16:15 | 200 |   10.059875ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 06:16:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:52767 -> [::]:62206), 160 bytes
2025/04/21 06:16:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:52767
2025/04/21 06:16:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:52767 -> [::]:62206)
2025/04/21 06:16:53 main.go:91: Plugin[example] [Info] resource config: /nhp-server/plugins/example/etc/resource.toml has been updated
2025/04/21 06:16:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:52767 -> [::]:62206), 160 bytes
2025/04/21 06:16:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:52767
2025/04/21 06:16:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:52767 -> [::]:62206)
2025/04/21 06:17:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:52767 -> [::]:62206), 293 bytes
2025/04/21 06:17:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:52767
2025/04/21 06:17:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 06:17:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:17:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:EBiIrtPogWBXyPtuyRJJf/Be8pu223rNC39qhssqGiiweVGk1zFI2LvWB25Pf5r9kr9cbkMDqygZaWDHRSmJ2w==
2025/04/21 06:17:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:+9mexrZ4wDzU4AlIZa11A2SmrWfCl563OpYzfayDZgs=,NonceBytes:AAAAAAAAAAAAAAAG,StaticBytes:agtxmU2yfoMlTfdj3qsMkrgKccl2TDpKKgdqT9iKtdSHoK+g2EWGvGk9Q/qbg9i7XE7k8p77Z9C4lR0naC9Gzb4BBM33sALYN1C77kqe8cY=
2025/04/21 06:17:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:17:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:17:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:17:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:17:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:17:17 transaction.go:229: NHP-Server [Debug] Remote transaction 6 start
2025/04/21 06:17:17 transaction.go:249: NHP-Server [Debug] Remote transaction 6 quit
2025/04/21 06:17:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 4: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:52767"}
2025/04/21 06:17:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 4: complete encrypting [NHP-AAK]
2025/04/21 06:17:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:17:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:17:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:52767), 297 bytes
2025/04/21 06:17:37 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:52767 -> [::]:62206), 160 bytes
2025/04/21 06:17:37 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:52767
2025/04/21 06:17:37 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:52767 -> [::]:62206)
2025/04/21 06:17:57 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:52767 -> [::]:62206), 160 bytes
2025/04/21 06:17:57 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:52767
2025/04/21 06:17:57 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:52767 -> [::]:62206)
2025/04/21 06:18:10 main.go:91: Plugin[example] [Info] resource config: /nhp-server/plugins/example/etc/resource.toml has been updated
2025/04/21 06:18:17 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:52767 -> [::]:62206), 293 bytes
2025/04/21 06:18:17 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:52767
2025/04/21 06:18:17 device.go:335: NHP-Server [Debug] packetToMsgRoutine 9: decrypting [NHP-AOL] raw packet
2025/04/21 06:18:17 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:18:17 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:cI9VJqyCpPBL/F5FoTlA6BZYCR6RTgSsoPuiv4mDmHILQLVwUKbwS8+Lqid5hWtfZiRrfGGhWXMBqFd4wd6U0g==
2025/04/21 06:18:17 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:dcnbD4g9G80Gi4UBeUXN3pZM9mo/k+kzFBKgoAhQMuM=,NonceBytes:AAAAAAAAAAAAAAAJ,StaticBytes:2rkOQCKtl7fZi/jOk7nYgI0aISdQhQOMi5n1rGFmXJiJeSBO6UrGsJvLRsMaAnnWST/ZxHv6HErCofqjtegOGk5NSzZNAxPu5nlYr8jqv+E=
2025/04/21 06:18:17 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 9: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:18:17 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:18:17 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:18:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:18:17 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:18:17 transaction.go:229: NHP-Server [Debug] Remote transaction 9 start
2025/04/21 06:18:17 transaction.go:249: NHP-Server [Debug] Remote transaction 9 quit
2025/04/21 06:18:17 device.go:182: NHP-Server [Debug] msgToPacketRoutine 5: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:52767"}
2025/04/21 06:18:17 device.go:233: NHP-Server [Debug] msgToPacketRoutine 5: complete encrypting [NHP-AAK]
2025/04/21 06:18:17 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:18:17 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:18:17 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:52767), 297 bytes
2025/04/21 06:28:59 udpserver.go:126: NHP-Server [Info] =========================================================
2025/04/21 06:28:59 udpserver.go:127: NHP-Server [Info] === NHP-Server 0.5.0.250421035448 started              ===
2025/04/21 06:28:59 udpserver.go:128: NHP-Server [Info] === REVISION cbfaf9bbedb364d30f679380e29dabfab73f0ec3 ===
2025/04/21 06:28:59 udpserver.go:129: NHP-Server [Info] === RELEASE 2025-04-21 03:54:48                       ===
2025/04/21 06:28:59 udpserver.go:130: NHP-Server [Info] =========================================================
2025/04/21 06:28:59 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/config.toml
2025/04/21 06:28:59 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/ac.toml
2025/04/21 06:28:59 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/agent.toml
2025/04/21 06:28:59 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/de.toml
2025/04/21 06:28:59 httpserver.go:42: NHP-Server [Info] ==================================================
2025/04/21 06:28:59 httpserver.go:43: NHP-Server [Info] ===  HttpServer (2025-04-21 06:28:59) started  ===
2025/04/21 06:28:59 httpserver.go:44: NHP-Server [Info] ==================================================
2025/04/21 06:28:59 httpserver.go:180: NHP-Server [Info] gin load file example/example_acdemo.html from /nhp-server/templates
2025/04/21 06:28:59 httpserver.go:180: NHP-Server [Info] gin load file example/example_login.html from /nhp-server/templates
2025/04/21 06:28:59 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/http.toml
2025/04/21 06:28:59 httpserver.go:106: NHP-Server [Info] Listening http on 0.0.0.0:62206
2025/04/21 06:28:59 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/srcip.toml
2025/04/21 06:28:59 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/config.toml
2025/04/21 06:28:59 file.go:124: NHP-Server [Info] start watching file /nhp-server/plugins/example/etc/resource.toml
2025/04/21 06:28:59 udpserver.go:746: NHP-Server [Info] plugin example v0.1.1 loaded successfully to example
2025/04/21 06:28:59 serverpluginhandler.go:138: NHP-Server [Error] open plugin zydd/zydd.so failed: plugin.Open("/nhp-server/plugins/zydd/zydd.so"): realpath failed
2025/04/21 06:28:59 serverpluginhandler.go:138: NHP-Server [Error] open plugin passcode/passcode.so failed: plugin.Open("/nhp-server/plugins/passcode/passcode.so"): realpath failed
2025/04/21 06:28:59 file.go:124: NHP-Server [Info] start watching file /nhp-server/etc/resource.toml
2025/04/21 06:28:59 device.go:159: NHP-Server [Info] msgToPacketRoutine 5: start
2025/04/21 06:28:59 device.go:159: NHP-Server [Info] msgToPacketRoutine 0: start
2025/04/21 06:28:59 device.go:316: NHP-Server [Info] packetToMsgRoutine 0: start
2025/04/21 06:28:59 device.go:159: NHP-Server [Info] msgToPacketRoutine 3: start
2025/04/21 06:28:59 device.go:316: NHP-Server [Info] packetToMsgRoutine 2: start
2025/04/21 06:28:59 device.go:159: NHP-Server [Info] msgToPacketRoutine 2: start
2025/04/21 06:28:59 device.go:159: NHP-Server [Info] msgToPacketRoutine 9: start
2025/04/21 06:28:59 device.go:316: NHP-Server [Info] packetToMsgRoutine 3: start
2025/04/21 06:28:59 device.go:159: NHP-Server [Info] msgToPacketRoutine 4: start
2025/04/21 06:28:59 device.go:316: NHP-Server [Info] packetToMsgRoutine 4: start
2025/04/21 06:28:59 udpserver.go:271: NHP-Server [Debug] recvPacketRoutine started
2025/04/21 06:28:59 device.go:159: NHP-Server [Info] msgToPacketRoutine 6: start
2025/04/21 06:28:59 device.go:316: NHP-Server [Info] packetToMsgRoutine 6: start
2025/04/21 06:28:59 device.go:159: NHP-Server [Info] msgToPacketRoutine 7: start
2025/04/21 06:28:59 device.go:316: NHP-Server [Info] packetToMsgRoutine 7: start
2025/04/21 06:28:59 device.go:159: NHP-Server [Info] msgToPacketRoutine 8: start
2025/04/21 06:28:59 device.go:316: NHP-Server [Info] packetToMsgRoutine 8: start
2025/04/21 06:28:59 device.go:159: NHP-Server [Info] msgToPacketRoutine 1: start
2025/04/21 06:28:59 tokenstore.go:71: NHP-Server [Info] tokenStoreRefreshRoutine started
2025/04/21 06:28:59 device.go:316: NHP-Server [Info] packetToMsgRoutine 1: start
2025/04/21 06:28:59 udpserver.go:508: NHP-Server [Info] BlockedAddrRoutine started
2025/04/21 06:28:59 udpserver.go:589: NHP-Server [Info] recvMessageRoutine started
2025/04/21 06:28:59 udpserver.go:559: NHP-Server [Info] sendMessageRoutine started
2025/04/21 06:28:59 device.go:316: NHP-Server [Info] packetToMsgRoutine 5: start
2025/04/21 06:28:59 device.go:316: NHP-Server [Info] packetToMsgRoutine 9: start
2025/04/21 06:28:59 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:18833 -> [::]:62206), 293 bytes
2025/04/21 06:28:59 udpserver.go:383: NHP-Server [Debug] Received new ac connection from 192.168.65.1:18833
2025/04/21 06:28:59 udpserver.go:391: NHP-Server [Info] Accept new UDP connection from 192.168.65.1:18833 to [::]:62206
2025/04/21 06:28:59 udpserver.go:406: NHP-Server [Debug] Connection routine: 192.168.65.1:18833 started
2025/04/21 06:28:59 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:18833
2025/04/21 06:28:59 device.go:335: NHP-Server [Debug] packetToMsgRoutine 0: decrypting [NHP-AOL] raw packet
2025/04/21 06:28:59 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:28:59 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:wXSAoKwRGWNh7yzmS9V/58Ongy4JuounPLgT7GTtJV1JOeKv0FytkeAneJRJeD3CEAxIg3O2HJxCFwbQAz5XVw==
2025/04/21 06:28:59 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:pJ4WarvaOXnimdTf5Do9HyDEk/RfSbKdYnc76kXT2UE=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:b2NBStMoClqxXHhXUZ7itesx/krD9oCWG9w3g4kQGBhUd+3qq3lp8d6GERqAxjBRNM5PqxLtVbSiWEDJ6ng48xxdjENubfWxcMYwr6UFSbo=
2025/04/21 06:28:59 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 0: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:28:59 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:28:59 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:28:59 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:28:59 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:28:59 transaction.go:229: NHP-Server [Debug] Remote transaction 1 start
2025/04/21 06:28:59 transaction.go:249: NHP-Server [Debug] Remote transaction 1 quit
2025/04/21 06:28:59 device.go:182: NHP-Server [Debug] msgToPacketRoutine 5: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:18833"}
2025/04/21 06:28:59 device.go:233: NHP-Server [Debug] msgToPacketRoutine 5: complete encrypting [NHP-AAK]
2025/04/21 06:28:59 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:28:59 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:28:59 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:18833), 297 bytes
2025/04/21 06:29:19 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:18833 -> [::]:62206), 160 bytes
2025/04/21 06:29:19 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:18833
2025/04/21 06:29:19 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:18833 -> [::]:62206)
2025/04/21 06:29:26 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=login
2025/04/21 06:29:26 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:29:26 | 200 |      2.5895ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=login"
2025/04/21 06:29:39 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:18833 -> [::]:62206), 160 bytes
2025/04/21 06:29:39 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:18833
2025/04/21 06:29:39 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:18833 -> [::]:62206)
2025/04/21 06:29:40 httpserver.go:208: NHP-Server [Info] get plugins request. aspId: example, query: resid=demo&action=valid&username=user&password=password
2025/04/21 06:29:40 device.go:182: NHP-Server [Debug] msgToPacketRoutine 0: encrypting [NHP-AOP] raw message: {"usrId":"","devId":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36","aspId":"example","resId":"demo","srcAddrs":[{"ip":"192.168.65.1"}],"dstAddrs":[{"ip":"172.18.0.3","port":80}],"opnTime":20}
2025/04/21 06:29:40 initiator.go:130: NHP-Server [Info] start encryption using CIPHER_SCHEME_GMSM
2025/04/21 06:29:40 device.go:233: NHP-Server [Debug] msgToPacketRoutine 0: complete encrypting [NHP-AOP]
2025/04/21 06:29:40 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:3
2025/04/21 06:29:40 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:29:40 device.go:255: NHP-Server [Debug] AddLocalTransaction:deviceType=2,HeaderType=3
2025/04/21 06:29:40 udpserver.go:262: NHP-Server [Info] Send [NHP-AOP] packet ([::]:62206 -> 192.168.65.1:18833), 460 bytes
2025/04/21 06:29:40 transaction.go:138: NHP-Server [Debug] Local transaction 1 start
2025/04/21 06:29:40 udpserver.go:322: NHP-Server [Info] Receive [NHP-ART] packet (192.168.65.1:18833 -> [::]:62206), 349 bytes
2025/04/21 06:29:40 udpserver.go:465: NHP-Server [Debug] Received udp packet len [349] from addr: 192.168.65.1:18833
2025/04/21 06:29:40 transaction.go:173: NHP-Server [Debug] Local transaction 1 quit
2025/04/21 06:29:40 device.go:335: NHP-Server [Debug] packetToMsgRoutine 2: decrypting [NHP-ART] raw packet
2025/04/21 06:29:40 responder.go:241: NHP-Server [Debug] headType:NHP-ART,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:gwM6d6yDBm5M8QXO3S9OnFyGJconHI1muM2Ywv96wMIT+4O391cieIRymsRQuoVuuC/yMSn39k6D35E0RlgbFA==
2025/04/21 06:29:40 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:rQniPwCK3iBJ6Emt8euM6lTenEKo5FbMVJu2hpS9MpU=,NonceBytes:AAAAAAAAAAAAAAAB,StaticBytes:5N+bwFtQFwmH4je0r1zJAgXU0XPLZkIWWdRsu8X+ynODkZ7QK2WWThZivI6P/CvLidYu6D/0ZTJN94Hg4GgnZAqOUF5IyIt8tWQlcPVkLYo=
2025/04/21 06:29:40 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 2: complete decrypting [NHP-ART] message: {"errCode":"0","opnTime":20,"token":"YMi/URRSG5Qz7teQKl/VpyqVPtoOYsud0HTACMwsnd8=","preAct":null}
2025/04/21 06:29:40 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-ART
2025/04/21 06:29:40 device.go:394: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh  is not nil
2025/04/21 06:29:40 httpserver.go:402: NHP-Server [Info] httpserver-agent(#Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36@192.168.65.1)[handleHttpOpenResource] succeed
2025/04/21 06:29:40 main.go:242: Plugin[example] [Info] knock succeeded.
2025/04/21 06:29:40 main.go:276: Plugin[example] [Info] ctx.SetCookie.
2025/04/21 06:29:40 httpauth.go:32: NHP-Server [Info] auth completed successfully
[GIN] 2025/04/21 - 06:29:40 | 200 |   25.814041ms |    192.168.65.1 | GET      "/plugins/example?resid=demo&action=valid&username=user&password=password"
2025/04/21 06:30:04 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:18833 -> [::]:62206), 160 bytes
2025/04/21 06:30:04 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:18833
2025/04/21 06:30:04 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:18833 -> [::]:62206)
2025/04/21 06:30:24 udpserver.go:322: NHP-Server [Info] Receive [NHP-KPL] packet (192.168.65.1:18833 -> [::]:62206), 160 bytes
2025/04/21 06:30:24 udpserver.go:465: NHP-Server [Debug] Received udp packet len [160] from addr: 192.168.65.1:18833
2025/04/21 06:30:24 udpserver.go:470: NHP-Server [Info] Receive [NHP_KPL] message (192.168.65.1:18833 -> [::]:62206)
2025/04/21 06:30:44 udpserver.go:322: NHP-Server [Info] Receive [NHP-AOL] packet (192.168.65.1:18833 -> [::]:62206), 293 bytes
2025/04/21 06:30:44 udpserver.go:465: NHP-Server [Debug] Received udp packet len [293] from addr: 192.168.65.1:18833
2025/04/21 06:30:44 device.go:335: NHP-Server [Debug] packetToMsgRoutine 3: decrypting [NHP-AOL] raw packet
2025/04/21 06:30:44 responder.go:122: NHP-Server [Info] start decryption using CIPHER_SCHEME_GMSM
2025/04/21 06:30:44 responder.go:241: NHP-Server [Debug] headType:NHP-AOL,validatePeer pubkey: 4/p0mIknwmVIMocRLQKil7xIthgEdZNncv9UagiBaK2kpcH7i4hEtZjpcHox+Bn7xdV+rBKNbKlV9ye6V1VCLA==,EphermeralBytes:xHGQH1vsrTnEC7QwT3J2Kw0dDx1DdmTYgZEMBmcm+ESH99zYqD/VUHMlyBZofe8CswDJNsGn7Q808CIMUB7HIA==
2025/04/21 06:30:44 responder.go:272: NHP-Server [Debug] ppd.Ciphers.GcmType:1,&key:A+qMz77+CFQsDc18JisoVs/H1HpcpeFApL1yVYXOdE8=,NonceBytes:AAAAAAAAAAAAAAAG,StaticBytes:1cyXXlr3BkSF5WeOSfC5ERca84xsmSWkRq5K3xPAfDRbZaLM01O0TRlJkifLKOUujuqfnQzC8dyvoMhkauLGF3ebq8ZEnr9LCdSaHwpCUZI=
2025/04/21 06:30:44 device.go:382: NHP-Server [Debug] packetToMsgRoutine: 3: complete decrypting [NHP-AOL] message: {"aspId":"","resIds":null,"acId":"testAC-1"}
2025/04/21 06:30:44 device.go:384: NHP-Server [Debug] packetToMsgRoutine: complete decrypting feedbackMsgCh:2,headerType:NHP-AOL
2025/04/21 06:30:44 device.go:399: NHP-Server [Debug] packetToMsgRoutine: complete decrypting start IsTransactionRequest:deviceType:2,headerType:NHP-AOL
2025/04/21 06:30:44 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:30:44 device.go:410: NHP-Server [Debug] IsTransactionRequest:true
2025/04/21 06:30:44 transaction.go:229: NHP-Server [Debug] Remote transaction 6 start
2025/04/21 06:30:44 transaction.go:249: NHP-Server [Debug] Remote transaction 6 quit
2025/04/21 06:30:44 device.go:182: NHP-Server [Debug] msgToPacketRoutine 3: encrypting [NHP-AAK] raw message: {"errCode":"0","acAddr":"192.168.65.1:18833"}
2025/04/21 06:30:44 device.go:233: NHP-Server [Debug] msgToPacketRoutine 3: complete encrypting [NHP-AAK]
2025/04/21 06:30:44 device.go:243: NHP-Server [Debug] msgToPacketRoutine IsTransactionRequest:deviceType:2 HeaderType:11
2025/04/21 06:30:44 transaction.go:30: NHP-Server [Info] IsTransactionRequest: deviceType:2
2025/04/21 06:30:44 udpserver.go:262: NHP-Server [Info] Send [NHP-AAK] packet ([::]:62206 -> 192.168.65.1:18833), 297 bytes
